version 0808151630
CREATE INDEX mail_mail_id_index ON mailitem USING btree (mail_id);
CREATE INDEX family_message_id_index ON family_schedule USING btree (family_id, message_id);
CREATE INDEX player_characters_family_index ON player_characters USING btree (id, family_id);
CREATE INDEX player_characters_family_id_index ON player_characters USING btree (family_id);
CREATE INDEX player_characters_deleted_time_index ON player_characters USING btree (deleted_time);
CREATE INDEX inventory_player_container_index ON inventory USING btree (player_id, container_index);
CREATE INDEX bags_pi_container_index ON bags USING btree (player_id, container_index);
CREATE INDEX equipment_player_container_index ON equipment USING btree (player_id, container_index);
CREATE INDEX storage_player_container_index ON "storage" USING btree (player_id, container_index);
CREATE INDEX player_appellation_index ON "player_appellation" USING btree (player_id);
CREATE INDEX auction_id_index ON auction USING btree (id);
CREATE INDEX auction_duedate_index ON auction USING btree (auction_duedate);
DROP INDEX elf_ci_index;
CREATE INDEX elf_player_index ON elf USING btree (player_id);
CREATE INDEX player_mail_receiver_id_index ON player_mail USING btree (receiver_id, id);

version 0809251830
ALTER TABLE inventory drop CONSTRAINT inventory_pkey  RESTRICT;
DROP INDEX inventory_index;
DROP INDEX inventory_player_index;
DROP INDEX inventory_player_container_index;
ALTER TABLE inventory RENAME TO inventory_old;
CREATE TABLE inventory (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT -1,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,loc integer NOT NULL);
ALTER TABLE public.inventory OWNER TO postgres;
REVOKE ALL ON TABLE inventory FROM PUBLIC;
GRANT ALL ON TABLE inventory TO spiritking;
CREATE INDEX inventory_item_index ON inventory USING btree (item_id);
CREATE UNIQUE INDEX inventory_index ON inventory USING btree (player_id, loc, container_index);
CREATE INDEX inventory_player_container_index ON inventory USING btree (player_id, container_index);
CREATE INDEX inventory_player_index ON inventory USING btree (player_id);
INSERT INTO inventory (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc FROM inventory_old;
DROP TABLE inventory_old;

ALTER TABLE auction drop CONSTRAINT auction_pkey  RESTRICT;
DROP INDEX auction_index;
DROP INDEX auction_duedate_index;
DROP INDEX auction_seller_id_index;
DROP INDEX auction_item_type_index;
DROP INDEX auction_seller_index;
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
ALTER TABLE auction RENAME TO auction_old;
CREATE TABLE auction (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT -1,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,seller_id integer DEFAULT 0,item_type integer DEFAULT 0,level integer DEFAULT 0,class integer DEFAULT 0,quality integer DEFAULT 0,quality_filter integer DEFAULT 0,auction_duedate integer DEFAULT 0,auction_price integer DEFAULT 0);
ALTER TABLE public.auction OWNER TO postgres;
REVOKE ALL ON TABLE auction FROM PUBLIC;
GRANT ALL ON TABLE auction TO spiritking;
CREATE INDEX auction_index ON auction USING btree (item_id);
CREATE INDEX auction_duedate_index ON auction USING btree (auction_duedate);
CREATE UNIQUE INDEX auction_seller_id_index ON auction USING btree (seller_id, id);
CREATE INDEX auction_item_type_index ON auction USING btree (item_type);
CREATE INDEX auction_seller_index ON auction USING btree (seller_id);
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";
INSERT INTO auction (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,seller_id,item_type,level,class,quality,quality_filter,auction_duedate,auction_price) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,seller_id,item_type,level,class,quality,quality_filter,auction_duedate,auction_price FROM auction_old;
DROP TABLE auction_old;

ALTER TABLE bags drop CONSTRAINT bags_pkey  RESTRICT;
DROP INDEX bags_index;
DROP INDEX bags_loc_index;
DROP INDEX bags_pi_container_index;
DROP INDEX bags_pi_index;
ALTER TABLE bags RENAME TO bags_old;
CREATE TABLE bags (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT -1,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,loc integer NOT NULL);
ALTER TABLE public.bags OWNER TO postgres;
REVOKE ALL ON TABLE bags FROM PUBLIC;
GRANT ALL ON TABLE bags TO spiritking;
CREATE INDEX bags_index ON bags USING btree (item_id);
CREATE UNIQUE INDEX bags_loc_index ON bags USING btree (player_id, loc, container_index);
CREATE INDEX bags_pi_container_index ON bags USING btree (player_id, container_index);
CREATE INDEX bags_pi_index ON bags USING btree (player_id);
INSERT INTO bags (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc FROM bags_old;
DROP TABLE bags_old;

ALTER TABLE elf_container drop CONSTRAINT elf_container_pkey  RESTRICT;
DROP INDEX elf_container_index;
DROP INDEX elf_container_elf_index;
DROP INDEX elf_container_loc_index;
ALTER TABLE elf_container RENAME TO elf_container_old;
CREATE TABLE elf_container (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT -1,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,elf_id integer NOT NULL,player_id integer NOT NULL,loc integer NOT NULL);
ALTER TABLE public.elf_container OWNER TO postgres;
REVOKE ALL ON TABLE elf_container FROM PUBLIC;
GRANT ALL ON TABLE elf_container TO spiritking;
CREATE INDEX elf_container_index ON elf_container USING btree (item_id);
CREATE INDEX elf_container_elf_index ON elf_container USING btree (elf_id);
CREATE UNIQUE INDEX elf_container_loc_index ON elf_container USING btree (elf_id, loc);
INSERT INTO elf_container (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,elf_id,player_id,loc) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,elf_id,player_id,loc FROM elf_container_old;
DROP TABLE elf_container_old;

ALTER TABLE equipment drop CONSTRAINT equipment_pkey  RESTRICT;
DROP INDEX equipment_index;
DROP INDEX equipment_loc_index;
DROP INDEX equipment_player_container_index;
DROP INDEX equipment_player_index;
ALTER TABLE equipment RENAME TO equipment_old;
CREATE TABLE equipment (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT -1,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,loc integer NOT NULL);
ALTER TABLE public.equipment OWNER TO postgres;
REVOKE ALL ON TABLE equipment FROM PUBLIC;
GRANT ALL ON TABLE equipment TO spiritking;
CREATE INDEX equipment_index ON equipment USING btree (item_id);
CREATE UNIQUE INDEX equipment_loc_index ON equipment USING btree (player_id, loc, container_index);
CREATE INDEX equipment_player_container_index ON equipment USING btree (player_id, container_index);
CREATE INDEX equipment_player_index ON equipment USING btree (player_id);
INSERT INTO equipment (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc FROM equipment_old;
DROP TABLE equipment_old;

ALTER TABLE mailitem drop CONSTRAINT mailitem_pkey  RESTRICT;
DROP INDEX mailitem_index;
DROP INDEX mail_id_index;
DROP INDEX mail_mail_id_index;
DROP INDEX mailitem_mailid_index;
DROP INDEX mailitem_player_index;
ALTER TABLE mailitem RENAME TO mailitem_old;
CREATE TABLE mailitem (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT -1,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,mail_id integer NOT NULL);
ALTER TABLE public.mailitem OWNER TO postgres;
REVOKE ALL ON TABLE mailitem FROM PUBLIC;
GRANT ALL ON TABLE mailitem TO spiritking;
CREATE INDEX mailitem_index ON mailitem USING btree (item_id);
CREATE INDEX mail_id_index ON mailitem USING btree (id);
CREATE INDEX mail_mail_id_index ON mailitem USING btree (mail_id);
CREATE UNIQUE INDEX mailitem_mailid_index ON mailitem USING btree (player_id, mail_id);
CREATE INDEX mailitem_player_index ON mailitem USING btree (player_id);
INSERT INTO mailitem (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,mail_id) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,mail_id FROM mailitem_old;
DROP TABLE mailitem_old;

ALTER TABLE storage drop CONSTRAINT storage_pkey  RESTRICT;
DROP INDEX storage_index;
DROP INDEX storage_loc_index;
DROP INDEX storage_player_container_index;
DROP INDEX storage_player_index;
ALTER TABLE storage RENAME TO storage_old;
CREATE TABLE storage (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT -1,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,loc integer NOT NULL);
ALTER TABLE public.storage OWNER TO postgres;
REVOKE ALL ON TABLE storage FROM PUBLIC;
GRANT ALL ON TABLE storage TO spiritking;
CREATE INDEX storage_index ON storage USING btree (item_id);
CREATE UNIQUE INDEX storage_loc_index ON "storage" USING btree (player_id, loc, container_index);
CREATE INDEX storage_player_container_index ON "storage" USING btree (player_id, container_index);
CREATE INDEX storage_player_index ON "storage" USING btree (player_id);
INSERT INTO storage (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc FROM storage_old;
DROP TABLE storage_old;

DROP TABLE family_storage;
DROP TABLE quest_inventory;
DROP TABLE clone_item;



version 0809261408
DROP TABLE message_board;
CREATE TABLE message_board (message_id integer NOT NULL,title character varying NOT NULL,content character varying NOT NULL,player_name character varying(20) NOT NULL,create_date integer NOT NULL);
REVOKE ALL ON TABLE message_board FROM PUBLIC;
GRANT ALL ON TABLE message_board TO spiritking;

version 0810160000
DROP INDEX auction_index;
DROP INDEX auction_seller_id_index;
DROP INDEX bags_index;
DROP INDEX bags_loc_index;
DROP INDEX bags_pi_container_index;
CREATE UNIQUE INDEX bags_loc_index ON bags USING btree (player_id, container_index, loc);
DROP INDEX equipment_index;
DROP INDEX equipment_loc_index;
DROP INDEX equipment_player_container_index;
DROP INDEX equipment_player_index;
CREATE UNIQUE INDEX equipment_loc_index ON equipment USING btree (player_id, container_index, loc);
DROP INDEX inventory_item_index;
DROP UNIQUE INDEX inventory_index;
DROP INDEX inventory_player_container_index;
DROP INDEX inventory_player_index;
CREATE UNIQUE INDEX inventory_index ON inventory USING btree (player_id, container_index, loc);
DROP INDEX mailitem_index ON mailitem;
DROP INDEX mail_id_index;
DROP INDEX mail_mail_id_index;
DROP INDEX mailitem_player_index;

DROP INDEX storage_index;
DROP INDEX storage_loc_index;
DROP INDEX storage_player_container_index;
DROP INDEX storage_player_index;
CREATE UNIQUE INDEX storage_loc_index ON "storage" USING btree (player_id, container_index, loc);

DROP INDEX elf_container_index;
DROP INDEX elf_container_elf_index;

DROP INDEX family_cadre_members_key;
DROP INDEX family_id_index;

DROP INDEX player_mail_receiver_index;
DROP INDEX player_spellcard_index;
DROP INDEX prestige_ci_index;
DROP INDEX shortcut_menu_ci_index;
DROP INDEX transport_ci_index;

version 0810210000
CREATE INDEX inventory_player_index ON inventory USING btree (player_id);
version 0810210001
ALTER TABLE player_characters DROP CONSTRAINT player_characters_pkey;
version 0810220000
ALTER TABLE personal_mission_states DROP CONSTRAINT personal_mission_states_index;
DROP INDEX personal_mission_states_pi_index;
CREATE INDEX personal_mission_states_pi_index ON personal_mission_states USING btree (id, index);

version 0901070000
DROP INDEX auction_auction_price_index;
CREATE INDEX auction_auction_price_index ON auction ("auction_price");
DROP INDEX auction_quality_index;
CREATE INDEX auction_quality_index ON auction ("quality");
DROP INDEX auction_level_index;
CREATE INDEX auction_level_index ON auction ("level");
DROP INDEX auction_class_index;
CREATE INDEX auction_class_index ON auction ("class");

version 0901101600
ALTER TABLE player_characters ADD max_aa_point integer;
ALTER TABLE player_characters ALTER max_aa_point SET DEFAULT 0;
UPDATE player_characters SET max_aa_point = 0;
ALTER TABLE player_characters ADD aa_point integer;
ALTER TABLE player_characters ALTER aa_point SET DEFAULT 0;
UPDATE player_characters SET aa_point = 0;
ALTER TABLE player_characters ADD aa_exp integer;
ALTER TABLE player_characters ALTER aa_exp SET DEFAULT 0;
UPDATE player_characters SET aa_exp = 0;
ALTER TABLE player_characters ADD aa_rate integer;
ALTER TABLE player_characters ALTER aa_rate SET DEFAULT 0;
UPDATE player_characters SET aa_rate = 0;
DROP TABLE advanced_ability;
CREATE TABLE advanced_ability (player_id integer NOT NULL,effect_id integer NOT NULL,point integer DEFAULT 0);
REVOKE ALL ON TABLE advanced_ability FROM PUBLIC;
GRANT ALL ON TABLE advanced_ability TO spiritking;

version 0901212100
DROP INDEX advanced_ability_index;
CREATE INDEX advanced_ability_index ON advanced_ability USING btree (player_id, effect_id);

version 0902131200
ALTER TABLE elf ADD work_count integer;
ALTER TABLE elf ALTER work_count SET DEFAULT 1;
UPDATE elf SET work_count = 1;

version 0902191000
ALTER TABLE player_characters RENAME COLUMN family_message0_state to family_msgboard_state;
ALTER TABLE player_characters DROP family_message1_state;
ALTER TABLE player_characters DROP family_message2_state;
ALTER TABLE player_characters DROP family_message3_state;
ALTER TABLE player_characters DROP family_message4_state;
ALTER TABLE player_characters DROP family_message5_state;
ALTER TABLE player_characters DROP family_message6_state;
ALTER TABLE player_characters DROP family_message7_state;
ALTER TABLE player_characters ADD self_comment character varying(256);
UPDATE player_characters SET self_comment = '';
ALTER TABLE player_characters ADD family_comment character varying(256);
UPDATE player_characters SET family_comment = '';

ALTER TABLE family RENAME COLUMN invite to invite_privilege;
ALTER TABLE family RENAME COLUMN kickout to kickout_privilege;
ALTER TABLE family RENAME COLUMN setcadre to setcadre_privilege;
ALTER TABLE family RENAME COLUMN editinfo to editinfo_privilege;
ALTER TABLE family RENAME COLUMN setschedule to msgboard_privilege;
ALTER TABLE family RENAME COLUMN channel to channel_privilege;
ALTER TABLE family ADD comment_privilege integer;
ALTER TABLE family ALTER comment_privilege SET DEFAULT 1;
UPDATE family SET comment_privilege = 1;
DROP TABLE family_schedule;
DROP TABLE family_msgboard;
CREATE TABLE family_msgboard (family_id integer NOT NULL,message_id integer NOT NULL,title character varying NOT NULL,content character varying NOT NULL,player_name character varying(20) NOT NULL,create_date integer NOT NULL);
DROP INDEX family_message_id_index;
CREATE INDEX family_message_id_index ON family_msgboard USING btree (family_id, message_id);
REVOKE ALL ON TABLE family_msgboard FROM PUBLIC;
GRANT ALL ON TABLE family_msgboard TO spiritking;

version 0902241000
ALTER TABLE family ADD treasury integer;
ALTER TABLE family ALTER treasury SET DEFAULT 0;
UPDATE family SET treasury = 0;
ALTER TABLE family ADD tax_rate integer;
ALTER TABLE family ALTER tax_rate SET DEFAULT 0;
UPDATE family SET tax_rate = 0;

version 0903052000
ALTER TABLE collection drop CONSTRAINT collection_pkey  RESTRICT;
DROP INDEX collection_index;
ALTER TABLE collection RENAME TO collection_old;
CREATE TABLE collection (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,create_time integer DEFAULT 1,due_date integer DEFAULT 0,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,account_id integer NOT NULL);
ALTER TABLE public.collection OWNER TO postgres;
REVOKE ALL ON TABLE collection FROM PUBLIC;
GRANT ALL ON TABLE collection TO spiritking;
CREATE INDEX collection_index ON collection USING btree (account_id);
INSERT INTO collection (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,combo_id,strengthen,cur_maxdurability,bind,account_id) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,combo_id,strengthen,cur_maxdurability,bind,account_id FROM collection_old;
DROP TABLE collection_old;

version 0903301708
DROP TABLE player_characters_achievement;
CREATE TABLE player_characters_achievement(player_id integer NOT NULL,achievement_id integer NOT NULL, point integer NOT NULL);
DROP INDEX player_characters_achievement_index;
CREATE INDEX player_characters_achievement_index ON player_characters_achievement USING btree (player_id, achievement_id);
ALTER TABLE public.player_characters_achievement OWNER TO postgres;
REVOKE ALL ON TABLE player_characters_achievement FROM PUBLIC;
GRANT ALL ON TABLE player_characters_achievement TO spiritking;

DROP TABLE family_achievement;
CREATE TABLE family_achievement(family_id integer NOT NULL,achievement_type integer NOT NULL, point integer NOT NULL);
DROP INDEX family_achievement_index;
CREATE INDEX family_achievement_index ON family_achievement USING btree (family_id, achievement_type);
ALTER TABLE public.family_achievement OWNER TO postgres;
REVOKE ALL ON TABLE family_achievement FROM PUBLIC;
GRANT ALL ON TABLE family_achievement TO spiritking;

DROP TABLE family_achievement_log;
CREATE TABLE family_achievement_log(family_id integer NOT NULL,player_id integer NOT NULL,achievement_id integer NOT NULL, point integer NOT NULL, date integer NOT NULL);
DROP INDEX family_achievement_log_index;
CREATE INDEX family_achievement_index ON family_achievement_log USING btree (family_id, player_id, date);
ALTER TABLE public.family_achievement_log OWNER TO postgres;
REVOKE ALL ON TABLE family_achievement_log FROM PUBLIC;
GRANT ALL ON TABLE family_achievement_log TO spiritking;

ALTER TABLE player_characters ADD family_contribution_point integer;
ALTER TABLE player_characters ALTER family_contribution_point SET DEFAULT 0;
UPDATE player_characters SET family_contribution_point = 0;

DROP TABLE battlefield_month;
CREATE TABLE battlefield_month(player_id integer PRIMARY KEY,join_count integer NOT NULL,win_count integer NOT NULL,lose_count integer NOT NULL,mvp_count integer NOT NULL,hight_score integer NOT NULL,kill_count integer NOT NULL,die_count integer NOT NULL,hight_kill integer NOT NULL,hight_die integer NOT NULL,hight_damage integer NOT NULL,hight_altar_damage integer NOT NULL, hight_cure integer NOT NULL);
DROP INDEX battlefield_month_index;
ALTER TABLE public.battlefield_month OWNER TO postgres;
REVOKE ALL ON TABLE battlefield_month FROM PUBLIC;
GRANT ALL ON TABLE battlefield_month TO spiritking;

DROP TABLE battlefield_career;
CREATE TABLE battlefield_career(player_id integer PRIMARY KEY,join_count integer NOT NULL,win_count integer NOT NULL,lose_count integer NOT NULL,mvp_count integer NOT NULL,hight_score integer NOT NULL,kill_count integer NOT NULL,die_count integer NOT NULL,hight_kill integer NOT NULL,hight_die integer NOT NULL,hight_damage integer NOT NULL,hight_altar_damage integer NOT NULL, hight_cure integer NOT NULL);
DROP INDEX battlefield_career_index;
ALTER TABLE public.battlefield_career OWNER TO postgres;
REVOKE ALL ON TABLE battlefield_career FROM PUBLIC;
GRANT ALL ON TABLE battlefield_career TO spiritking;

ALTER TABLE family ADD family_skill_point integer;
ALTER TABLE family ALTER family_skill_point SET DEFAULT 0;
UPDATE family SET family_skill_point = 0;


version 0904142204
Drop table illplugininfo;
CREATE TABLE illplugininfo(accountname character varying(32) NOT NULL,modulename character varying(260),exepathinfo character varying(260),servername character varying(32),clientversion character varying(20),playerhostname character varying(128), playerip character varying(20),worldid integer, playername character varying(32), datetime integer, playernetaddr character varying(24),windowsversion character varying(32));
ALTER TABLE illplugininfo OWNER TO postgres;
GRANT ALL ON TABLE illplugininfo TO postgres;
GRANT ALL ON TABLE illplugininfo TO spiritking;
CREATE INDEX illplugininfo_accountname_index ON illplugininfo USING btree (accountname);
CREATE INDEX illplugininfo_datetime_index ON illplugininfo USING btree (datetime);
CREATE INDEX illplugininfo_modulename_index ON illplugininfo USING btree (modulename);
CREATE INDEX illplugininfo_playerip_index ON illplugininfo USING btree (playerip);
CREATE INDEX illplugininfo_playername_index ON illplugininfo USING btree (playername);

version 0904171200
ALTER TABLE family ADD elfking_tid integer;
ALTER TABLE family ALTER elfking_tid SET DEFAULT 0;
UPDATE family SET elfking_tid = 0;
ALTER TABLE family ADD spell_privilege integer;
ALTER TABLE family ALTER spell_privilege SET DEFAULT 1;
UPDATE family SET spell_privilege = 1;
ALTER TABLE family RENAME COLUMN family_skill_point to spell_point;

version 0904211003
DROP TABLE family_achievement_log;
CREATE TABLE family_achievement_log(family_id integer NOT NULL,player_id integer NOT NULL,achievement_id integer NOT NULL, point integer NOT NULL, date integer NOT NULL, log_id integer NOT NULL);
DROP INDEX family_achievement_log_index;
CREATE INDEX family_achievement_log_index ON family_achievement_log USING btree (log_id);
ALTER TABLE public.family_achievement_log OWNER TO postgres;
REVOKE ALL ON TABLE family_achievement_log FROM PUBLIC;
GRANT ALL ON TABLE family_achievement_log TO spiritking;

version 0904260940
DROP TABLE player_achievement_rank;
CREATE TABLE player_achievement_rank(player_id integer PRIMARY KEY, player_name character varying(32) DEFAULT '', player_lv integer NOT NULL, player_class integer NOT NULL, update_time integer NOT NULL, total_point integer NOT NULL, monster_kill integer NOT NULL, festival_type integer NOT NULL, mission_type integer NOT NULL, lv01_instance_node integer NOT NULL, lv31_instance_node integer NOT NULL, lv46_instance_node integer NOT NULL, lv61_instance_node integer NOT NULL, lv76_instance_node integer NOT NULL, lv91_instance_node integer NOT NULL, family_boss integer NOT NULL, rare_monster integer NOT NULL, world_boss integer NOT NULL, activity integer NOT NULL, mission_chaslot integer NOT NULL, mission_elia integer NOT NULL, mission_gear integer NOT NULL, mission_arsalan integer NOT NULL, mission_bluewhale integer NOT NULL, mission_other integer NOT NULL);
DROP INDEX player_achievement_rank_index;
ALTER TABLE public.player_achievement_rank OWNER TO postgres;
REVOKE ALL ON TABLE player_achievement_rank FROM PUBLIC;
GRANT ALL ON TABLE player_achievement_rank TO spiritking;

DROP TABLE family_achievement_rank;
CREATE TABLE family_achievement_rank(family_id integer PRIMARY KEY, family_name character varying(32) DEFAULT '', update_time integer NOT NULL, total_point integer NOT NULL, monster_kill integer NOT NULL, festival_type integer NOT NULL, mission_type integer NOT NULL, lv01_instance_node integer NOT NULL, lv31_instance_node integer NOT NULL, lv46_instance_node integer NOT NULL, lv61_instance_node integer NOT NULL, lv76_instance_node integer NOT NULL, lv91_instance_node integer NOT NULL, family_boss integer NOT NULL, rare_monster integer NOT NULL, world_boss integer NOT NULL, activity integer NOT NULL, mission_chaslot integer NOT NULL, mission_elia integer NOT NULL, mission_gear integer NOT NULL, mission_arsalan integer NOT NULL, mission_bluewhale integer NOT NULL, mission_other integer NOT NULL);
DROP INDEX family_achievement_rank_index;
ALTER TABLE public.family_achievement_rank OWNER TO postgres;
REVOKE ALL ON TABLE family_achievement_rank FROM PUBLIC;
GRANT ALL ON TABLE family_achievement_rank TO spiritking;

DROP TABLE battlefield_month;
CREATE TABLE battlefield_month(player_id integer PRIMARY KEY, player_name character varying(32) DEFAULT '', player_lv integer NOT NULL, player_class integer NOT NULL, join_count integer NOT NULL,win_count integer NOT NULL,lose_count integer NOT NULL,mvp_count integer NOT NULL,hight_score integer NOT NULL,kill_count integer NOT NULL,die_count integer NOT NULL,hight_kill integer NOT NULL,hight_die integer NOT NULL,hight_damage integer NOT NULL,hight_altar_damage integer NOT NULL, hight_cure integer NOT NULL);
DROP INDEX battlefield_month_index;
ALTER TABLE public.battlefield_month OWNER TO postgres;
REVOKE ALL ON TABLE battlefield_month FROM PUBLIC;
GRANT ALL ON TABLE battlefield_month TO spiritking;

DROP TABLE battlefield_career;
CREATE TABLE battlefield_career(player_id integer PRIMARY KEY, player_name character varying(32) DEFAULT '', player_lv integer NOT NULL, player_class integer NOT NULL, join_count integer NOT NULL,win_count integer NOT NULL,lose_count integer NOT NULL,mvp_count integer NOT NULL,hight_score integer NOT NULL,kill_count integer NOT NULL,die_count integer NOT NULL,hight_kill integer NOT NULL,hight_die integer NOT NULL,hight_damage integer NOT NULL,hight_altar_damage integer NOT NULL, hight_cure integer NOT NULL);
DROP INDEX battlefield_career_index;
ALTER TABLE public.battlefield_career OWNER TO postgres;
REVOKE ALL ON TABLE battlefield_career FROM PUBLIC;
GRANT ALL ON TABLE battlefield_career TO spiritking;

ALTER TABLE serverstatus ADD last_start_time integer;
ALTER TABLE serverstatus ALTER last_start_time SET DEFAULT 0;
UPDATE serverstatus SET last_start_time = 0;

version 0904291400
DROP INDEX family_achievement_log_index;
CREATE INDEX family_achievement_log_index ON family_achievement_log USING btree (log_id, family_id);

version 0904291700
DROP INDEX player_characters_achievement_index;
ALTER TABLE player_characters_achievement ADD CONSTRAINT player_characters_achievement_pkey PRIMARY KEY (player_id, achievement_id);

version 0904291840
DROP TABLE victory_declaration;
CREATE TABLE victory_declaration (player_id integer PRIMARY KEY,content character varying NOT NULL);
REVOKE ALL ON TABLE victory_declaration FROM PUBLIC;
GRANT ALL ON TABLE victory_declaration TO spiritking;

version 0904301900
DROP TABLE statues_scenes;
CREATE TABLE statues_scenes (worldserver_id integer,node_id integer,template_id integer,family_id integer,player_name character varying(32) DEFAULT '',gender_id integer,face integer,hair integer,equip_head integer,equip_chest integer,equip_pants integer,equip_glove integer,equip_feet integer,equip_back integer,equip_right integer,equip_left integer,equip_shoot integer,weapon_active integer,ride_id integer,transform_id integer,action_id integer,frame_key double precision);
REVOKE ALL ON TABLE statues_scenes FROM PUBLIC;
GRANT ALL ON TABLE statues_scenes TO spiritking;

version 0905221951
ALTER TABLE equipment ADD lock_pwd character varying(32);
ALTER TABLE equipment ALTER lock_pwd SET DEFAULT '*';
UPDATE equipment SET lock_pwd = '*';
ALTER TABLE equipment ADD unlock_time integer;
ALTER TABLE equipment ALTER unlock_time SET DEFAULT 0;
UPDATE equipment SET unlock_time = 0;

ALTER TABLE inventory ADD lock_pwd character varying(32);
ALTER TABLE inventory ALTER lock_pwd SET DEFAULT '*';
UPDATE inventory SET lock_pwd = '*';
ALTER TABLE inventory ADD unlock_time integer;
ALTER TABLE inventory ALTER unlock_time SET DEFAULT 0;
UPDATE inventory SET unlock_time = 0;

ALTER TABLE storage ADD lock_pwd character varying(32);
ALTER TABLE storage ALTER lock_pwd SET DEFAULT '*';
UPDATE storage SET lock_pwd = '*';
ALTER TABLE storage ADD unlock_time integer;
ALTER TABLE storage ALTER unlock_time SET DEFAULT 0;
UPDATE storage SET unlock_time = 0;

ALTER TABLE elf_container ADD lock_pwd character varying(32);
ALTER TABLE elf_container ALTER lock_pwd SET DEFAULT '*';
UPDATE elf_container SET lock_pwd = '*';
ALTER TABLE elf_container ADD unlock_time integer;
ALTER TABLE elf_container ALTER unlock_time SET DEFAULT 0;
UPDATE elf_container SET unlock_time = 0;

ALTER TABLE bags ADD lock_pwd character varying(32);
ALTER TABLE bags ALTER lock_pwd SET DEFAULT '*';
UPDATE bags SET lock_pwd = '*';
ALTER TABLE bags ADD unlock_time integer;
ALTER TABLE bags ALTER unlock_time SET DEFAULT 0;
UPDATE bags SET unlock_time = 0;

ALTER TABLE collection ADD lock_pwd character varying(32);
ALTER TABLE collection ALTER lock_pwd SET DEFAULT '*';
UPDATE collection SET lock_pwd = '*';
ALTER TABLE collection ADD unlock_time integer;
ALTER TABLE collection ALTER unlock_time SET DEFAULT 0;
UPDATE collection SET unlock_time = 0;

ALTER TABLE mailitem ADD lock_pwd character varying(32);
ALTER TABLE mailitem ALTER lock_pwd SET DEFAULT '*';
UPDATE mailitem SET lock_pwd = '*';
ALTER TABLE mailitem ADD unlock_time integer;
ALTER TABLE mailitem ALTER unlock_time SET DEFAULT 0;
UPDATE mailitem SET unlock_time = 0;

ALTER TABLE auction ADD lock_pwd character varying(32);
ALTER TABLE auction ALTER lock_pwd SET DEFAULT '*';
UPDATE auction SET lock_pwd = '*';
ALTER TABLE auction ADD unlock_time integer;
ALTER TABLE auction ALTER unlock_time SET DEFAULT 0;
UPDATE auction SET unlock_time = 0;

version 0905271400
ALTER TABLE statues_scenes ADD CONSTRAINT statues_scenes_pkey PRIMARY KEY(worldserver_id,node_id,template_id,family_id);

version 0905310070
DROP TABLE sys_mail_queue;
CREATE TABLE sys_mail_queue (receiver_id integer NOT NULL,	title character varying (40) DEFAULT '', content character varying DEFAULT ''::character varying, gold integer DEFAULT 0, item_id integer NOT NULL, durability integer NOT NULL, maker character varying(32) DEFAULT ''::character varying, rank integer DEFAULT 0, identify smallint DEFAULT 1, magic smallint DEFAULT 0, embedded_amount integer DEFAULT 0, embedded_id1 integer DEFAULT (-1), embedded_id2 integer DEFAULT (-1), embedded_id3 integer DEFAULT (-1), embedded_id4 integer DEFAULT (-1), embedded_id5 integer DEFAULT (-1), embedded_id6 integer DEFAULT (-1), create_time integer DEFAULT 1, due_date integer DEFAULT 0, combo_id integer DEFAULT 0, strengthen integer DEFAULT 0, cur_maxdurability integer DEFAULT 0, bind integer DEFAULT 0);
CREATE INDEX sys_mail_queue_index ON sys_mail_queue USING btree (receiver_id);

version 0906030000
ALTER TABLE sys_mail_queue ADD clone_item_id integer;
ALTER TABLE sys_mail_queue ALTER clone_item_id SET DEFAULT -1;

version 0906090000
ALTER TABLE sys_mail_queue OWNER TO postgres;
REVOKE ALL ON TABLE sys_mail_queue FROM PUBLIC;
GRANT ALL ON TABLE sys_mail_queue TO spiritking;

version 0906102000
DROP TABLE lover;
CREATE TABLE lover (id integer NOT NULL, coin integer NOT NULL DEFAULT 0, point integer NOT NULL DEFAULT 0, create_time integer NOT NULL, update_coin_time integer NOT NULL DEFAULT 0, message character varying(256) NOT NULL DEFAULT ''::character varying, CONSTRAINT lover_pkey PRIMARY KEY (id));
ALTER TABLE lover OWNER TO postgres;
REVOKE ALL ON TABLE lover FROM PUBLIC;
GRANT ALL ON TABLE lover TO spiritking;

ALTER TABLE player_characters ADD lover_id integer;
ALTER TABLE player_characters ALTER lover_id SET DEFAULT 0;
UPDATE player_characters SET lover_id = 0;

version 0906111800
CREATE INDEX player_characters_index ON "player_characters" USING btree (lover_id);

version 0906151100
ALTER TABLE family ADD house_open integer;
ALTER TABLE family ALTER house_open SET DEFAULT 0;
UPDATE family SET house_open = 0;


version 0906181100
ALTER TABLE family ADD family_flag bigint;
ALTER TABLE family ALTER family_flag SET DEFAULT 0;
UPDATE family SET family_flag = 0;


version 0906231200
ALTER TABLE elf ADD game_win integer;
ALTER TABLE elf ADD game_lose integer;
ALTER TABLE elf ADD game_ko integer;
ALTER TABLE elf ADD game_winmsg character varying(32);
ALTER TABLE elf ADD game_jan_al smallint;
ALTER TABLE elf ADD game_ken_al smallint;
ALTER TABLE elf ADD game_pon_al smallint;
ALTER TABLE elf ADD game_jan_dl smallint;
ALTER TABLE elf ADD game_ken_dl smallint;
ALTER TABLE elf ADD game_pon_dl smallint;
ALTER TABLE elf ADD game_jan_ae integer;
ALTER TABLE elf ADD game_ken_ae integer;
ALTER TABLE elf ADD game_pon_ae integer;
ALTER TABLE elf ADD game_jan_de integer;
ALTER TABLE elf ADD game_ken_de integer;
ALTER TABLE elf ADD game_pon_de integer;
ALTER TABLE elf ALTER game_win SET DEFAULT 0;
ALTER TABLE elf ALTER game_lose SET DEFAULT 0;
ALTER TABLE elf ALTER game_ko SET DEFAULT 0;
ALTER TABLE elf ALTER game_winmsg SET DEFAULT '';
ALTER TABLE elf ALTER game_jan_al SET DEFAULT 1;
ALTER TABLE elf ALTER game_ken_al SET DEFAULT 1;
ALTER TABLE elf ALTER game_pon_al SET DEFAULT 1;
ALTER TABLE elf ALTER game_jan_dl SET DEFAULT 1;
ALTER TABLE elf ALTER game_ken_dl SET DEFAULT 1;
ALTER TABLE elf ALTER game_pon_dl SET DEFAULT 1;
ALTER TABLE elf ALTER game_jan_ae SET DEFAULT 0;
ALTER TABLE elf ALTER game_ken_ae SET DEFAULT 0;
ALTER TABLE elf ALTER game_pon_ae SET DEFAULT 0;
ALTER TABLE elf ALTER game_jan_de SET DEFAULT 0;
ALTER TABLE elf ALTER game_ken_de SET DEFAULT 0;
ALTER TABLE elf ALTER game_pon_de SET DEFAULT 0;
UPDATE elf SET game_win = 0,game_lose = 0,game_ko = 0,game_winmsg = '',game_jan_al = 1,game_ken_al = 1,game_pon_al = 1,game_jan_dl = 1,game_ken_dl = 1,game_pon_dl = 1,game_jan_ae = 0,game_ken_ae = 0,game_pon_ae = 0, game_jan_de = 0,game_ken_de = 0,game_pon_de = 0;


version 0907011900
ALTER TABLE family ADD storage01_privilege smallint;
ALTER TABLE family ALTER storage01_privilege SET DEFAULT 1;
UPDATE family SET storage01_privilege = 1;
ALTER TABLE family ADD storage02_privilege smallint;
ALTER TABLE family ALTER storage02_privilege SET DEFAULT 1;
UPDATE family SET storage02_privilege = 1;
ALTER TABLE family ADD storage03_privilege smallint;
ALTER TABLE family ALTER storage03_privilege SET DEFAULT 1;
UPDATE family SET storage03_privilege = 1;

ALTER TABLE family_storage drop CONSTRAINT family_storage_pkey  RESTRICT;
DROP INDEX family_storage_index;
ALTER TABLE family_storage RENAME TO family_storage_old;
CREATE TABLE family_storage (id integer PRIMARY KEY,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT -1,embedded_id2 integer DEFAULT -1,embedded_id3 integer DEFAULT -1,embedded_id4 integer DEFAULT -1,embedded_id5 integer DEFAULT -1,embedded_id6 integer DEFAULT -1,loc smallint NOT NULL,create_time integer DEFAULT 1,due_date integer DEFAULT 0,combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,lock_pwd character varying(32) DEFAULT '*', unlock_time integer DEFAULT 0, family_id integer DEFAULT 0, container_index smallint NOT NULL);
ALTER TABLE public.family_storage OWNER TO postgres;
REVOKE ALL ON TABLE family_storage FROM PUBLIC;
GRANT ALL ON TABLE family_storage TO spiritking;
CREATE INDEX family_storage_index ON family_storage USING btree (family_id);
INSERT INTO family_storage (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,loc,create_time,due_date,combo_id,strengthen,cur_maxdurability,bind,lock_pwd,unlock_time,family_id,container_index) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,loc,create_time,due_date,combo_id,strengthen,cur_maxdurability,bind,lock_pwd,unlock_time,family_id,container_index FROM family_storage_old;
DROP TABLE family_storage_old;

DROP TABLE family_storage_log;
CREATE TABLE family_storage_log (family_id integer NOT NULL, log_type smallint NOT NULL, log character varying(256) NOT NULL DEFAULT ''::character varying, log_time integer NOT NULL);
ALTER TABLE family_storage_log OWNER TO postgres;
REVOKE ALL ON TABLE family_storage_log FROM PUBLIC;
GRANT ALL ON TABLE family_storage_log TO spiritking;
CREATE INDEX family_storage_log_index ON family_storage_log USING btree (family_id);

version 0907101100
ALTER TABLE sys_mail_queue ADD state character varying (16);
ALTER TABLE sys_mail_queue ALTER state SET DEFAULT 'New';

version 0907301600
DROP TABLE family_battle_championship;
CREATE TABLE family_battle_championship(game_num integer NOT NULL, family_id integer NOT NULL, family_name character varying (40) DEFAULT '', rank integer NOT NULL, camp_type integer NOT NULL);
DROP INDEX family_battle_championship_index;
CREATE INDEX family_battle_championship_index ON family_battle_championship USING btree (game_num, family_id, rank);
ALTER TABLE family_battle_championship ADD CONSTRAINT family_battle_championship_pkey PRIMARY KEY (game_num, family_id, rank);
ALTER TABLE public.family_battle_championship OWNER TO postgres;
REVOKE ALL ON TABLE family_battle_championship FROM PUBLIC;
GRANT ALL ON TABLE family_battle_championship TO spiritking;

DROP TABLE family_battle_data;
CREATE TABLE family_battle_data(area_id integer PRIMARY KEY, area_name character varying (40) DEFAULT '', family_id integer NOT NULL, week_type integer NOT NULL);
DROP INDEX family_battle_data_index;
CREATE INDEX family_battle_data_index ON family_battle_data USING btree (area_id, family_id);
ALTER TABLE public.family_battle_data OWNER TO postgres;
REVOKE ALL ON TABLE family_battle_data FROM PUBLIC;
GRANT ALL ON TABLE family_battle_data TO spiritking;

INSERT INTO family_battle_data(area_id, area_name, family_id, week_type) VALUES (1, 'chaslot', 0, 0); 
INSERT INTO family_battle_data(area_id, area_name, family_id, week_type) VALUES (2, 'elia', 0, 0);
INSERT INTO family_battle_data(area_id, area_name, family_id, week_type) VALUES (3, 'gear', 0, 0); 

version 0907301610
ALTER TABLE family_achievement ADD CONSTRAINT family_achievement_pkey PRIMARY KEY (family_id, achievement_type);
ALTER TABLE public.family_achievement OWNER TO postgres;

ALTER TABLE family ADD union_family_1 integer;
ALTER TABLE family ALTER union_family_1 SET DEFAULT 0;
ALTER TABLE family ADD union_family_2 integer;
ALTER TABLE family ALTER union_family_2 SET DEFAULT 0;
ALTER TABLE family ADD union_family_3 integer;
ALTER TABLE family ALTER union_family_3 SET DEFAULT 0;

version 0908031800
UPDATE player_characters_achievement SET achievement_id = 304001816 WHERE achievement_id = 304001817 and player_id not in (select player_id from player_characters_achievement where achievement_id = 304001816);
DELETE FROM player_characters_achievement WHERE achievement_id = 304001817;

version 0908221249
DROP TABLE family_battle_rank;
CREATE TABLE family_battle_rank(family_id integer PRIMARY KEY, family_name character varying(32) DEFAULT '', update_time integer NOT NULL, total_point integer NOT NULL, monster_kill integer NOT NULL, festival_type integer NOT NULL, mission_type integer NOT NULL, lv01_instance_node integer NOT NULL, lv31_instance_node integer NOT NULL, lv46_instance_node integer NOT NULL, lv61_instance_node integer NOT NULL, lv76_instance_node integer NOT NULL, lv91_instance_node integer NOT NULL, family_boss integer NOT NULL, rare_monster integer NOT NULL, world_boss integer NOT NULL, activity integer NOT NULL, mission_chaslot integer NOT NULL, mission_elia integer NOT NULL, mission_gear integer NOT NULL, mission_arsalan integer NOT NULL, mission_bluewhale integer NOT NULL, mission_other integer NOT NULL);
ALTER TABLE public.family_battle_rank OWNER TO postgres;
REVOKE ALL ON TABLE family_battle_rank FROM PUBLIC;
GRANT ALL ON TABLE family_battle_rank TO spiritking;

version 0908261520
ALTER TABLE family_battle_championship ADD execute_time integer;
ALTER TABLE family_battle_championship ALTER execute_time SET DEFAULT 0;
UPDATE family_battle_championship SET execute_time = 0;

version 0909171009
DROP TABLE family_battle_registration;
CREATE TABLE family_battle_registration(family_id integer PRIMARY KEY);
DROP INDEX family_battle_registration_index;
ALTER TABLE public.family_battle_registration OWNER TO postgres;
REVOKE ALL ON TABLE family_battle_registration FROM PUBLIC;

GRANT ALL ON TABLE family_battle_registration TO spiritking;

version 0909291800
ALTER TABLE battlefield_month ADD mvp_count_weight integer;
ALTER TABLE battlefield_month ALTER mvp_count_weight SET DEFAULT 0;

ALTER TABLE battlefield_month ADD kill_count_weight integer;
ALTER TABLE battlefield_month ALTER kill_count_weight SET DEFAULT 0;

UPDATE battlefield_month SET mvp_count_weight = 0, kill_count_weight = 0;

version 0910011800
DROP TABLE mission_dialogues;
DROP TABLE bulletin;
DROP TABLE greeting_dialogues;
DROP TABLE mission_state_transitions;
DROP TABLE mission_states;
DROP TABLE npc_greeting;
DROP TABLE scenario_mission;
DROP TABLE scenario_mission_key;
DROP TABLE scenario_template; 
DROP TABLE scenarios;
DROP TABLE state_condition_transitions;
DROP TABLE state_transition_on_dialogues;
DROP TABLE state_transition_operations;
DROP TABLE surprise_box;
DROP TABLE template_mission;
DROP TABLE hbo_version;

version 0910061700
ALTER TABLE player_characters ADD given_name_change integer default 0;

version 0910071010
ALTER TABLE battlefield_month DROP mvp_count_weight;
ALTER TABLE battlefield_month DROP kill_count_weight;

ALTER TABLE battlefield_month ADD mvp_count_weight double precision;
ALTER TABLE battlefield_month ALTER mvp_count_weight SET DEFAULT 0;

ALTER TABLE battlefield_month ADD kill_count_weight double precision;
ALTER TABLE battlefield_month ALTER kill_count_weight SET DEFAULT 0;

UPDATE battlefield_month SET mvp_count_weight = 0, kill_count_weight = 0;

version 0910141430
ALTER TABLE player_characters ADD spell_card_ground2 integer;
ALTER TABLE player_characters ALTER spell_card_ground2 SET DEFAULT 0;
ALTER TABLE player_characters ADD spell_card_star2 integer;
ALTER TABLE player_characters ALTER spell_card_star2 SET DEFAULT 0;
ALTER TABLE player_characters ADD spell_card_moon2 integer;
ALTER TABLE player_characters ALTER spell_card_moon2 SET DEFAULT 0;
ALTER TABLE player_characters ADD spell_card_sun2 integer;
ALTER TABLE player_characters ALTER spell_card_sun2 SET DEFAULT 0;
UPDATE player_characters SET spell_card_ground2 = 0, spell_card_star2 = 0, spell_card_moon2 = 0, spell_card_sun2 = 0;

version 0911191530
ALTER TABLE family_battle_championship ADD week_point integer;
ALTER TABLE family_battle_championship ALTER week_point SET DEFAULT 0;

version 0911251530
ALTER TABLE player_characters ADD elf_bot integer;
ALTER TABLE player_characters ALTER elf_bot SET DEFAULT 0;
UPDATE player_characters SET elf_bot = 0;

version 0912211130
DROP TABLE rank_award_mail_queue;
CREATE TABLE rank_award_mail_queue (receiver_id integer NOT NULL, rank_template_id integer NOT NULL, award_item_index integer NOT NULL);
CREATE INDEX rank_award_mail_queue_index ON rank_award_mail_queue USING btree (receiver_id);
ALTER TABLE public.rank_award_mail_queue OWNER TO postgres;
REVOKE ALL ON TABLE rank_award_mail_queue FROM PUBLIC;
GRANT ALL ON TABLE rank_award_mail_queue TO spiritking;

version 0912211200
DROP TABLE vip;
CREATE TABLE vip(id integer NOT NULL, silver_time integer DEFAULT 0, golden_time integer DEFAULT 0);
CREATE INDEX vip_index ON vip USING btree (id);

ALTER TABLE public.vip OWNER TO postgres;
REVOKE ALL ON TABLE vip FROM PUBLIC;
GRANT ALL ON TABLE vip TO spiritking;

ALTER TABLE serverstatus ADD last_vip_mail_time integer;
ALTER TABLE serverstatus ALTER last_vip_mail_time SET DEFAULT 0;
UPDATE serverstatus SET last_vip_mail_time = 0;

version 0912211300
ALTER TABLE elf ADD combo1 integer;
ALTER TABLE elf ADD combo2 integer;
ALTER TABLE elf ADD combo3 integer;
ALTER TABLE elf ALTER combo1 SET DEFAULT 0;
ALTER TABLE elf ALTER combo2 SET DEFAULT 0;
ALTER TABLE elf ALTER combo3 SET DEFAULT 0;
UPDATE elf SET combo1 = 0, combo2 = 0, combo3 = 0;

version 1001041300
ALTER TABLE elf ALTER game_pon_dl SET DEFAULT 1;
UPDATE elf SET game_pon_dl=1 WHERE game_pon_dl is NULL;

version 1001111730
ALTER TABLE player_characters ADD marked_point integer;
ALTER TABLE player_characters ALTER marked_point SET DEFAULT 0;
UPDATE player_characters SET marked_point = 0;

version 1001121530
DROP INDEX equipment_loc_index;
ALTER TABLE equipment ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE equipment ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE equipment SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;
CREATE UNIQUE INDEX equipment_loc_index ON equipment USING btree (player_id, loc, container_index);

DROP INDEX inventory_index;
DROP INDEX inventory_player_index;
ALTER TABLE inventory ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE inventory ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE inventory SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;
CREATE UNIQUE INDEX inventory_index ON inventory USING btree (player_id, loc, container_index);
CREATE INDEX inventory_player_index ON inventory USING btree (player_id);

DROP INDEX storage_loc_index;
ALTER TABLE storage ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE storage ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE storage SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;
CREATE UNIQUE INDEX storage_loc_index ON "storage" USING btree (player_id, loc, container_index);

DROP INDEX elf_container_con_index;
DROP INDEX elf_container_loc_index;
ALTER TABLE elf_container ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE elf_container ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE elf_container SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;
CREATE INDEX elf_container_con_index ON elf_container USING btree (player_id, container_index);
CREATE UNIQUE INDEX elf_container_loc_index ON elf_container USING btree (elf_id, loc);

DROP INDEX bags_loc_index;
DROP INDEX bags_pi_index;
ALTER TABLE bags ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE bags ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE bags SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;
CREATE UNIQUE INDEX bags_loc_index ON bags USING btree (player_id, loc, container_index);
CREATE INDEX bags_pi_index ON bags USING btree (player_id);

DROP INDEX collection_index;
ALTER TABLE collection ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE collection ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE collection SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;
CREATE INDEX collection_index ON collection USING btree (account_id);

DROP INDEX mailitem_index;
DROP INDEX mailitem_mailid_index;
ALTER TABLE mailitem ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE mailitem ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE mailitem SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;
CREATE INDEX mailitem_index ON mailitem USING btree (item_id);
CREATE UNIQUE INDEX mailitem_mailid_index ON mailitem USING btree (player_id, mail_id);

ALTER TABLE auction ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE auction ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE auction SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;

ALTER TABLE family_storage ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE family_storage ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE family_storage SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;

ALTER TABLE sys_mail_queue ADD extra_combo_id1 integer, ADD extra_combo_id2 integer, ADD  extra_combo_id3 integer, ADD extra_combo_id4 integer, ADD extra_combo_id5 integer, ADD extra_combo_id6 integer;
ALTER TABLE sys_mail_queue ALTER extra_combo_id1 SET DEFAULT 0, ALTER extra_combo_id2 SET DEFAULT 0, ALTER extra_combo_id3 SET DEFAULT 0, ALTER extra_combo_id4 SET DEFAULT 0, ALTER extra_combo_id5 SET DEFAULT 0, ALTER extra_combo_id6 SET DEFAULT 0;
UPDATE sys_mail_queue SET extra_combo_id1 = 0, extra_combo_id2 = 0, extra_combo_id3 = 0, extra_combo_id4 = 0, extra_combo_id5 = 0, extra_combo_id6 = 0;

DROP INDEX elf_ci_player_id_index;
DROP INDEX elf_player_index;
ALTER TABLE elf ADD extra_combo1_1 integer, ADD extra_combo1_2 integer, ADD  extra_combo1_3 integer, ADD extra_combo1_4 integer, ADD extra_combo1_5 integer, ADD extra_combo1_6 integer, ADD extra_combo2_1 integer, ADD extra_combo2_2 integer, ADD  extra_combo2_3 integer, ADD extra_combo2_4 integer, ADD extra_combo2_5 integer, ADD extra_combo2_6 integer, ADD extra_combo3_1 integer, ADD extra_combo3_2 integer, ADD  extra_combo3_3 integer, ADD extra_combo3_4 integer, ADD extra_combo3_5 integer, ADD extra_combo3_6 integer;
ALTER TABLE elf ALTER extra_combo1_1 SET DEFAULT 0, ALTER extra_combo1_2 SET DEFAULT 0, ALTER extra_combo1_3 SET DEFAULT 0, ALTER extra_combo1_4 SET DEFAULT 0, ALTER extra_combo1_5 SET DEFAULT 0, ALTER extra_combo1_6 SET DEFAULT 0, ALTER extra_combo2_1 SET DEFAULT 0, ALTER extra_combo2_2 SET DEFAULT 0, ALTER extra_combo2_3 SET DEFAULT 0, ALTER extra_combo2_4 SET DEFAULT 0, ALTER extra_combo2_5 SET DEFAULT 0, ALTER extra_combo2_6 SET DEFAULT 0, ALTER extra_combo3_1 SET DEFAULT 0, ALTER extra_combo3_2 SET DEFAULT 0, ALTER extra_combo3_3 SET DEFAULT 0, ALTER extra_combo3_4 SET DEFAULT 0, ALTER extra_combo3_5 SET DEFAULT 0, ALTER extra_combo3_6 SET DEFAULT 0;
UPDATE elf SET extra_combo1_1 = 0, extra_combo1_2 = 0, extra_combo1_3 = 0, extra_combo1_4 = 0, extra_combo1_5 = 0, extra_combo1_6 = 0, extra_combo2_1 = 0, extra_combo2_2 = 0, extra_combo2_3 = 0, extra_combo2_4 = 0, extra_combo2_5 = 0, extra_combo2_6 = 0, extra_combo3_1 = 0, extra_combo3_2 = 0, extra_combo3_3 = 0, extra_combo3_4 = 0, extra_combo3_5 = 0, extra_combo3_6 = 0;
CREATE UNIQUE INDEX elf_ci_player_id_index ON elf USING btree (elf_id, player_id);
CREATE INDEX elf_player_index ON elf USING btree (player_id);

DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1001191530
ALTER TABLE sys_mail_queue ADD sender_name character varying(32);
ALTER TABLE sys_mail_queue ALTER sender_name SET DEFAULT '';
UPDATE sys_mail_queue SET sender_name = '';

version 1001221610
ALTER TABLE player_characters ADD marked_point_id integer;
ALTER TABLE player_characters ALTER marked_point_id SET DEFAULT 0;
UPDATE player_characters SET marked_point_id = 0;



version 1001261610
ALTER TABLE auction ADD item_name character varying(64);
ALTER TABLE auction ALTER item_name SET DEFAULT '';
UPDATE auction SET item_name = '';

DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1002011610
ALTER TABLE family ADD recurit integer;
ALTER TABLE family ALTER recurit SET DEFAULT 0;
UPDATE family SET recurit = 0;

version 1002261430
CREATE INDEX friends_fi_index ON friends USING btree (friend_id);

version 1003111610
CREATE TABLE gold_log (date integer PRIMARY KEY, increase bigint DEFAULT 0, decrease bigint DEFAULT 0, range1 bigint DEFAULT 0, range2 bigint DEFAULT 0, range3 bigint DEFAULT 0, range4 bigint DEFAULT 0, range5 bigint DEFAULT 0, range6 bigint DEFAULT 0, range7 bigint DEFAULT 0, range8 bigint DEFAULT 0, range9 bigint DEFAULT 0, range10 bigint DEFAULT 0);
CREATE INDEX gold_log_index ON gold_log USING btree (date);
ALTER TABLE gold_log OWNER TO postgres;
REVOKE ALL ON TABLE gold_log FROM PUBLIC;
GRANT ALL ON TABLE gold_log TO spiritking;

version 1005101430
DROP TABLE player_luckystar;
CREATE TABLE player_luckystar (player_id integer NOT NULL, lucky_ticket_str character varying(16) DEFAULT ''::character varying, lucky_ticket integer DEFAULT 0, phase integer DEFAULT 0);
ALTER TABLE public.player_luckystar OWNER TO postgres;
REVOKE ALL ON TABLE player_luckystar FROM PUBLIC;
REVOKE ALL ON TABLE player_luckystar FROM postgres;
GRANT ALL ON TABLE player_luckystar TO postgres;
GRANT ALL ON TABLE player_luckystar TO spiritking;
CREATE INDEX player_luckystar_player_index ON player_luckystar USING btree (player_id);
CREATE INDEX player_luckystar_ticket_index ON player_luckystar USING btree (lucky_ticket_str, phase);

DROP TABLE server_luckystar; 
CREATE TABLE server_luckystar (current_lucky_ticket_str character varying(16) DEFAULT ''::character varying, current_lucky_ticket integer DEFAULT 0, last_lucky_ticket_str character varying(16) DEFAULT ''::character varying, last_lucky_ticket integer DEFAULT 0, current_phase integer DEFAULT 0, bonus integer DEFAULT 0, phase_due_date integer DEFAULT 0, CONSTRAINT player_server_luckystar_bonus CHECK ((("bonus" >= 0) AND ("bonus" <= 1200000000))));
ALTER TABLE public.server_luckystar OWNER TO postgres;
REVOKE ALL ON TABLE server_luckystar FROM PUBLIC;
REVOKE ALL ON TABLE server_luckystar FROM postgres;
GRANT ALL ON TABLE server_luckystar TO postgres;
GRANT ALL ON TABLE server_luckystar TO spiritking;

DROP TABLE server_luckystar_log; 
CREATE TABLE server_luckystar_log (phase integer DEFAULT 0, lucky_ticket_str character varying(16) DEFAULT ''::character varying, total_bonus integer DEFAULT 0, first_prize_count integer DEFAULT 0, second_prize_count integer DEFAULT 0, third_prize_count integer DEFAULT 0, first_prize integer DEFAULT 0, second_prize integer DEFAULT 0, third_prize integer DEFAULT 0);
ALTER TABLE public.server_luckystar_log OWNER TO postgres;
REVOKE ALL ON TABLE server_luckystar_log FROM PUBLIC;
REVOKE ALL ON TABLE server_luckystar_log FROM postgres;
GRANT ALL ON TABLE server_luckystar_log TO postgres;
GRANT ALL ON TABLE server_luckystar_log TO spiritking;

DROP TABLE server_lucky_bar; 
CREATE TABLE server_lucky_bar (zone_id integer DEFAULT 0, elf_no integer DEFAULT 0, elf_money integer DEFAULT 0);
ALTER TABLE public.server_lucky_bar OWNER TO postgres;
REVOKE ALL ON TABLE server_lucky_bar FROM PUBLIC;
REVOKE ALL ON TABLE server_lucky_bar FROM postgres;
GRANT ALL ON TABLE server_lucky_bar TO postgres;
GRANT ALL ON TABLE server_lucky_bar TO spiritking;
CREATE INDEX server_lucky_bar_index ON server_lucky_bar USING btree (zone_id);
CREATE INDEX server_lucky_bar_elf_no_index ON server_lucky_bar USING btree (elf_no);

version 1005121810
ALTER TABLE public.battlefield_month OWNER TO spiritking;
ALTER TABLE public.player_achievement_rank OWNER TO spiritking;
ALTER TABLE public.family_achievement_rank OWNER TO spiritking;

version 1005281154
ALTER TABLE player_characters DROP CONSTRAINT player_characters_exp;

version 1006021735
ALTER TABLE player_enchants ADD stack_count integer;
ALTER TABLE player_enchants ALTER stack_count SET DEFAULT 1;
UPDATE player_enchants SET stack_count = 1;

version 1006291530
DROP INDEX personal_mission_states_pi_index;
doexec TransformPMS
ALTER TABLE personal_mission_states ALTER index_old SET DEFAULT 0;
CREATE INDEX personal_mission_states_pi_index ON personal_mission_states USING btree (id, index);

version 1007042044
ALTER TABLE player_mail ADD authoritative integer DEFAULT 0;
UPDATE player_mail SET authoritative = 0;

version 1007060945
ALTER TABLE player_achievement_rank ADD event_one integer DEFAULT 0 NOT NULL;
ALTER TABLE player_achievement_rank ADD event_two integer DEFAULT 0 NOT NULL;
ALTER TABLE player_achievement_rank ADD event_three integer DEFAULT 0 NOT NULL;
ALTER TABLE player_achievement_rank ADD event_four integer DEFAULT 0 NOT NULL;
ALTER TABLE player_achievement_rank ADD event_five integer DEFAULT 0 NOT NULL;
UPDATE player_achievement_rank SET event_one = 0, event_two = 0, event_three = 0, event_four = 0, event_five = 0;

ALTER TABLE family_achievement_rank ADD event_one integer DEFAULT 0 NOT NULL;
ALTER TABLE family_achievement_rank ADD event_two integer DEFAULT 0 NOT NULL;
ALTER TABLE family_achievement_rank ADD event_three integer DEFAULT 0 NOT NULL;
ALTER TABLE family_achievement_rank ADD event_four integer DEFAULT 0 NOT NULL;
ALTER TABLE family_achievement_rank ADD event_five integer DEFAULT 0 NOT NULL;
UPDATE family_achievement_rank SET event_one = 0, event_two = 0, event_three = 0, event_four = 0, event_five = 0;

ALTER TABLE family_battle_rank ADD event_one integer DEFAULT 0 NOT NULL;
ALTER TABLE family_battle_rank ADD event_two integer DEFAULT 0 NOT NULL;
ALTER TABLE family_battle_rank ADD event_three integer DEFAULT 0 NOT NULL;
ALTER TABLE family_battle_rank ADD event_four integer DEFAULT 0 NOT NULL;
ALTER TABLE family_battle_rank ADD event_five integer DEFAULT 0 NOT NULL;
UPDATE family_battle_rank SET event_one = 0, event_two = 0, event_three = 0, event_four = 0, event_five = 0;

version 1009081700
CREATE TABLE recommended_events(player_id integer,recommended_id integer,target_number integer DEFAULT 0,PRIMARY KEY (player_id,recommended_id));
CREATE INDEX recommended_events_index ON recommended_events USING btree (player_id);
ALTER TABLE recommended_events OWNER TO postgres;
REVOKE ALL ON TABLE recommended_events FROM PUBLIC;
GRANT ALL ON TABLE recommended_events TO spiritking;

version 1009081701
ALTER TABLE player_characters ADD recommended_events_time integer;
ALTER TABLE player_characters ALTER recommended_events_time SET DEFAULT 0;
UPDATE player_characters SET recommended_events_time = 0;

version 1010221910
ALTER TABLE player_characters ADD society_option integer;
ALTER TABLE player_characters ALTER society_option SET DEFAULT 0;
UPDATE player_characters SET society_option = 0;

version 1012081020
ALTER TABLE player_achievement_rank ADD mission_deep integer DEFAULT 0 NOT NULL;
UPDATE player_achievement_rank SET mission_deep = 0;

ALTER TABLE family_achievement_rank ADD mission_deep integer DEFAULT 0 NOT NULL;
UPDATE family_achievement_rank SET mission_deep = 0;

ALTER TABLE family_battle_rank ADD mission_deep integer DEFAULT 0 NOT NULL;
UPDATE family_battle_rank SET mission_deep = 0;

version 1012301830
ALTER TABLE family_battle_championship ADD score integer;
ALTER TABLE family_battle_championship ALTER score SET DEFAULT -1;
UPDATE family_battle_championship SET score = -1;

version 1103091020
ALTER TABLE equipment ADD witchcraft integer DEFAULT 0;
ALTER TABLE inventory ADD witchcraft integer DEFAULT 0;
ALTER TABLE storage ADD witchcraft integer DEFAULT 0;
ALTER TABLE elf_container ADD witchcraft integer DEFAULT 0;
ALTER TABLE bags ADD witchcraft integer DEFAULT 0;
ALTER TABLE collection ADD witchcraft integer DEFAULT 0;
ALTER TABLE mailitem ADD witchcraft integer DEFAULT 0;
ALTER TABLE auction ADD witchcraft integer DEFAULT 0;
ALTER TABLE family_storage ADD witchcraft integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD witchcraft integer DEFAULT 0;

DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1103152140
DROP INDEX recommended_events_index
DROP TABLE recommended_events_old;
ALTER TABLE recommended_events RENAME TO recommended_events_old;
CREATE TABLE recommended_events(player_id integer,recommended_id integer,count integer DEFAULT 0, target_number1 integer DEFAULT 0, target_number2 integer DEFAULT 0,target_number3 integer DEFAULT 0,target_number4 integer DEFAULT 0,target_number5 integer DEFAULT 0,PRIMARY KEY (player_id,recommended_id));
CREATE INDEX recommended_events_index ON recommended_events USING btree (player_id);
ALTER TABLE recommended_events OWNER TO postgres;
REVOKE ALL ON TABLE recommended_events FROM PUBLIC;
GRANT ALL ON TABLE recommended_events TO spiritking;

version 1104061645
UPDATE player_enchants SET effect_id=effect_id-15000 WHERE effect_id >= -23535 AND effect_id <= -13536;
UPDATE player_enchants SET effect_id=effect_id+65536;

version 1104192000
ALTER TABLE elf ADD game_jan_count integer DEFAULT 0;
ALTER TABLE elf ADD game_ken_count integer DEFAULT 0;
ALTER TABLE elf ADD game_pon_count integer DEFAULT 0;

ALTER TABLE recommended_events ADD target_number integer DEFAULT 0;

version 1105091200
ALTER TABLE elf ADD gold1 integer DEFAULT 0;
ALTER TABLE elf ADD gold2 integer DEFAULT 0;
ALTER TABLE elf ADD gold3 integer DEFAULT 0;

ALTER TABLE elf ADD witchcraft1 integer DEFAULT 0;
ALTER TABLE elf ADD witchcraft2 integer DEFAULT 0;
ALTER TABLE elf ADD witchcraft3 integer DEFAULT 0;

ALTER TABLE elf ADD strengthen1 integer DEFAULT 0;
ALTER TABLE elf ADD strengthen2 integer DEFAULT 0;
ALTER TABLE elf ADD strengthen3 integer DEFAULT 0;

ALTER TABLE elf ADD embedded1_1 integer DEFAULT 0;
ALTER TABLE elf ADD embedded1_2 integer DEFAULT 0;
ALTER TABLE elf ADD embedded1_3 integer DEFAULT 0;
ALTER TABLE elf ADD embedded1_4 integer DEFAULT 0;
ALTER TABLE elf ADD embedded1_5 integer DEFAULT 0;
ALTER TABLE elf ADD embedded1_6 integer DEFAULT 0;

ALTER TABLE elf ADD embedded2_1 integer DEFAULT 0;
ALTER TABLE elf ADD embedded2_2 integer DEFAULT 0;
ALTER TABLE elf ADD embedded2_3 integer DEFAULT 0;
ALTER TABLE elf ADD embedded2_4 integer DEFAULT 0;
ALTER TABLE elf ADD embedded2_5 integer DEFAULT 0;
ALTER TABLE elf ADD embedded2_6 integer DEFAULT 0;

ALTER TABLE elf ADD embedded3_1 integer DEFAULT 0;
ALTER TABLE elf ADD embedded3_2 integer DEFAULT 0;
ALTER TABLE elf ADD embedded3_3 integer DEFAULT 0;
ALTER TABLE elf ADD embedded3_4 integer DEFAULT 0;
ALTER TABLE elf ADD embedded3_5 integer DEFAULT 0;
ALTER TABLE elf ADD embedded3_6 integer DEFAULT 0;

version 1105251600
DROP TABLE midnight_limit;
CREATE TABLE midnight_limit (player_id integer NOT NULL, function_type integer NOT NULL, due_date integer DEFAULT 0);
ALTER TABLE midnight_limit OWNER TO postgres;
REVOKE ALL ON TABLE midnight_limit FROM PUBLIC;
GRANT ALL ON TABLE midnight_limit TO spiritking;
CREATE UNIQUE INDEX midnight_limit_index ON midnight_limit USING btree (player_id, function_type);
CREATE INDEX midnight_limit_player_index ON midnight_limit USING btree (player_id);

version 1105271050
DROP VIEW "statues_scenes_view";
CREATE VIEW "statues_scenes_view" AS SELECT * FROM "statues_scenes";
DELETE FROM statues_scenes WHERE template_id in (SELECT template_id + 65536 FROM statues_scenes_view WHERE template_id < 0 and statues_scenes.worldserver_id = worldserver_id and statues_scenes.node_id = node_id );
DROP VIEW "statues_scenes_view";
UPDATE statues_scenes SET template_id = template_id + 65536 WHERE template_id < 0;

version 1105271200
ALTER TABLE elf ALTER embedded1_1 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded1_2 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded1_3 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded1_4 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded1_5 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded1_6 SET DEFAULT -1;

ALTER TABLE elf ALTER embedded2_1 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded2_2 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded2_3 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded2_4 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded2_5 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded2_6 SET DEFAULT -1;

ALTER TABLE elf ALTER embedded2_1 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded3_2 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded3_3 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded3_4 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded3_5 SET DEFAULT -1;
ALTER TABLE elf ALTER embedded3_6 SET DEFAULT -1;

UPDATE elf SET embedded1_1 = -1;
UPDATE elf SET embedded1_2 = -1;
UPDATE elf SET embedded1_3 = -1;
UPDATE elf SET embedded1_4 = -1;
UPDATE elf SET embedded1_5 = -1;
UPDATE elf SET embedded1_6 = -1;

UPDATE elf SET embedded2_1 = -1;
UPDATE elf SET embedded2_2 = -1;
UPDATE elf SET embedded2_3 = -1;
UPDATE elf SET embedded2_4 = -1;
UPDATE elf SET embedded2_5 = -1;
UPDATE elf SET embedded2_6 = -1;

UPDATE elf SET embedded3_1 = -1;
UPDATE elf SET embedded3_2 = -1;
UPDATE elf SET embedded3_3 = -1;
UPDATE elf SET embedded3_4 = -1;
UPDATE elf SET embedded3_5 = -1;
UPDATE elf SET embedded3_6 = -1;

version 1105301645
DROP TABLE territory_war;
CREATE TABLE territory_war(territory_id integer NOT NULL, own_family_id integer NOT NULL, own_times integer NOT NULL);
DROP INDEX territory_war_index;
CREATE INDEX territory_war_index ON territory_war USING btree (territory_id);
ALTER TABLE territory_war ADD CONSTRAINT territory_war_pkey PRIMARY KEY (territory_id);
ALTER TABLE public.territory_war OWNER TO postgres;
REVOKE ALL ON TABLE territory_war FROM PUBLIC;
GRANT ALL ON TABLE territory_war TO spiritking;

version 1106091100
ALTER TABLE elf ADD rework integer;
ALTER TABLE elf ALTER rework SET DEFAULT 0;
UPDATE elf SET rework = 0;

version 1106151530
UPDATE elf SET work_count = 1 where work_count = 0;

version 1106281200
ALTER TABLE elf ADD max_durability1 integer DEFAULT -1;
ALTER TABLE elf ADD max_durability2 integer DEFAULT -1;
ALTER TABLE elf ADD max_durability3 integer DEFAULT -1;

version 1107200401
ALTER TABLE elf ADD class_id integer DEFAULT 0;

version 1108091520
ALTER TABLE player_appellation ADD create_time integer DEFAULT 0;

version 1108241202
DROP TABLE sys_mail_queue_new;
CREATE TABLE sys_mail_queue_new (mail_id SERIAL, receiver_id integer NOT NULL, clone_item_id integer DEFAULT 0, state character varying (16) DEFAULT 'New', sender_name character varying(32) DEFAULT '', title character varying (40) DEFAULT '', content character varying DEFAULT ''::character varying, gold integer DEFAULT 0, item_id integer NOT NULL, durability integer NOT NULL, maker character varying(32) DEFAULT ''::character varying, rank integer DEFAULT 0, identify smallint DEFAULT 1, magic smallint DEFAULT 0, embedded_amount integer DEFAULT 0, embedded_id1 integer DEFAULT (-1), embedded_id2 integer DEFAULT (-1), embedded_id3 integer DEFAULT (-1), embedded_id4 integer DEFAULT (-1), embedded_id5 integer DEFAULT (-1), embedded_id6 integer DEFAULT (-1), create_time integer DEFAULT 1, due_date integer DEFAULT 0, combo_id integer DEFAULT 0, strengthen integer DEFAULT 0, cur_maxdurability integer DEFAULT 0, bind integer DEFAULT 0, extra_combo_id1 integer DEFAULT 0, extra_combo_id2 integer DEFAULT 0, extra_combo_id3 integer DEFAULT 0, extra_combo_id4 integer DEFAULT 0, extra_combo_id5 integer DEFAULT 0, extra_combo_id6 integer DEFAULT 0, witchcraft integer DEFAULT 0, CONSTRAINT mail_queue_pkey PRIMARY KEY (mail_id));
CREATE INDEX sys_mail_queue_receiver_index ON sys_mail_queue_new USING btree (receiver_id);

version 1110271120
ALTER TABLE family ADD fram_privilege integer DEFAULT 1;

version 1110271123
DROP TABLE family_crop;
CREATE TABLE family_crop (id SERIAL, family_id integer NOT NULL, loc integer NOT NULL, grower character varying(32) DEFAULT '', crop_tid integer NOT NULL, after_time integer DEFAULT 0, energy integer DEFAULT 1000000, record_time integer NOT NULL, CONSTRAINT family_crop_pkey PRIMARY KEY (id));
CREATE INDEX family_crop_index ON family_crop USING btree (family_id);
DROP TABLE family_crop_enchants;
CREATE TABLE family_crop_enchants (crop_id integer NOT NULL, effect_id integer NOT NULL, rest_time integer NOT NULL);
CREATE INDEX family_crop_enchants_index ON family_crop_enchants USING btree (crop_id);

version 1110271124
ALTER TABLE public.family_crop OWNER TO spiritking;
REVOKE ALL ON TABLE "family_crop" FROM "PUBLIC";
GRANT ALL ON TABLE "family_crop" TO "spiritking";
ALTER TABLE public.family_crop_enchants OWNER TO spiritking;
REVOKE ALL ON TABLE "family_crop_enchants" FROM "PUBLIC";
GRANT ALL ON TABLE "family_crop_enchants" TO "spiritking";

version 1111151736
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
ALTER TABLE auction ALTER COLUMN class TYPE bigint;
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1201031140
DROP TABLE isle;
CREATE TABLE isle (isle_id integer NOT NULL, name character varying (32) NOT NULL, durability integer NOT NULL, time_record integer NOT NULL, level integer DEFAULT 0, exp integer DEFAULT 0, style integer DEFAULT 0, CONSTRAINT isle_pkey PRIMARY KEY (isle_id));
DROP TABLE isle_record;
CREATE TABLE isle_record (id SERIAL, isle_id integer NOT NULL, visitor_id integer NOT NULL, name character varying (32) NOT NULL, enter_time integer NOT NULL, leave_time integer NOT NULL, kill_count integer NOT NULL, kill_score integer NOT NULL, repair_count integer NOT NULL, repair_score integer NOT NULL, opened integer DEFAULT 0, CONSTRAINT isle_record_pkey PRIMARY KEY (id));
CREATE INDEX isle_record_index ON isle_record USING btree (isle_id);
CREATE INDEX isle_record_time_index ON isle_record USING btree (leave_time);
DROP TABLE isle_altar;
CREATE TABLE isle_altar (isle_id integer NOT NULL, elf_id integer NOT NULL);
CREATE INDEX isle_altar_index ON isle_altar USING btree (isle_id);
DROP TABLE isle_statue;
CREATE TABLE isle_statue (isle_id integer NOT NULL, monster_id integer NOT NULL, color integer DEFAULT 0);
CREATE INDEX isle_statue_index ON isle_statue USING btree (isle_id);
DROP TABLE isle_blacklist;
CREATE TABLE isle_blacklist (isle_id integer NOT NULL, block_id integer NOT NULL, block_name character varying (32) NOT NULL, block_time integer NOT NULL);
CREATE INDEX isle_blacklist_index ON isle_blacklist USING btree (isle_id);
DROP TABLE isle_equipment;
CREATE TABLE isle_equipment (isle_id integer NOT NULL, loc_id integer NOT NULL, equipment_id integer NOT NULL, param integer NOT NULL);
CREATE INDEX isle_equipment_index ON isle_equipment USING btree (isle_id);

version 1201131140
DROP TABLE family_farm;
CREATE TABLE family_farm (family_id integer NOT NULL, loc integer NOT NULL, hire_time integer NOT NULL);
CREATE INDEX family_farm_index ON family_farm USING btree (family_id);

version 1201301030
ALTER TABLE serverstatus ADD next_itemmall_time integer;
ALTER TABLE serverstatus ALTER next_itemmall_time SET DEFAULT 0;
UPDATE serverstatus SET next_itemmall_time = 0;

version 1202041030
REVOKE ALL ON TABLE "sys_mail_queue_new" FROM "PUBLIC";
GRANT ALL ON TABLE "sys_mail_queue_new" TO "spiritking";
GRANT ALL ON TABLE "sys_mail_queue_new" TO "postgres";
REVOKE ALL ON TABLE "family_crop" FROM "PUBLIC";
GRANT ALL ON TABLE "family_crop" TO "spiritking";
GRANT ALL ON TABLE "family_crop" TO "postgres";
REVOKE ALL ON TABLE "family_crop_enchants" FROM "PUBLIC";
GRANT ALL ON TABLE "family_crop_enchants" TO "spiritking";
GRANT ALL ON TABLE "family_crop_enchants" TO "postgres";
REVOKE ALL ON TABLE "family_farm" FROM "PUBLIC";
GRANT ALL ON TABLE "family_farm" TO "spiritking";
GRANT ALL ON TABLE "family_farm" TO "postgres";
REVOKE ALL ON TABLE "isle" FROM "PUBLIC";
GRANT ALL ON TABLE "isle" TO "spiritking";
GRANT ALL ON TABLE "isle" TO "postgres";
REVOKE ALL ON TABLE "isle_record" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_record" TO "spiritking";
GRANT ALL ON TABLE "isle_record" TO "postgres";
REVOKE ALL ON TABLE "isle_altar" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_altar" TO "spiritking";
GRANT ALL ON TABLE "isle_altar" TO "postgres";
REVOKE ALL ON TABLE "isle_statue" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_statue" TO "spiritking";
GRANT ALL ON TABLE "isle_statue" TO "postgres";
REVOKE ALL ON TABLE "isle_blacklist" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_blacklist" TO "spiritking";
GRANT ALL ON TABLE "isle_blacklist" TO "postgres";
REVOKE ALL ON TABLE "isle_equipment" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_equipment" TO "spiritking";
GRANT ALL ON TABLE "isle_equipment" TO "postgres";
GRANT ALL(id) ON "family_crop" TO "spiritking" WITH GRANT OPTION;
GRANT ALL(id) ON "isle_record" TO "spiritking" WITH GRANT OPTION;

version 1202061031
ALTER TABLE isle_record ADD divine_time integer DEFAULT 0;
ALTER TABLE isle_record ADD divine_buf_id integer DEFAULT 0;
ALTER TABLE isle_record ADD fish_count integer DEFAULT 0;
ALTER TABLE isle_record ADD fish_score integer DEFAULT 0;
ALTER TABLE isle_record ADD feed_fish integer DEFAULT 0;
ALTER TABLE isle_record ADD feed_fish_score integer DEFAULT 0;

version 1202141549
ALTER TABLE isle ADD create_date character varying (32) NOT NULL;
ALTER TABLE isle ADD visits integer DEFAULT 0;
ALTER TABLE isle ADD grade integer DEFAULT 0;
ALTER TABLE isle ADD bulletin character varying (256) DEFAULT '';

version 1202171550
DROP TABLE isle_crop;
CREATE TABLE isle_crop (id SERIAL, isle_id integer NOT NULL, category integer NOT NULL, loc integer NOT NULL, grower character varying(32) DEFAULT '', crop_tid integer NOT NULL, after_time integer DEFAULT 0, energy integer DEFAULT 1000000, record_time integer NOT NULL, CONSTRAINT isle_crop_pkey PRIMARY KEY (id));
CREATE INDEX isle_crop_index ON isle_crop USING btree (isle_id);
DROP TABLE isle_crop_enchants;
CREATE TABLE isle_crop_enchants (crop_id integer NOT NULL, effect_id integer NOT NULL, rest_time integer NOT NULL);
CREATE INDEX isle_crop_enchants_index ON isle_crop_enchants USING btree (crop_id);

version 1202171551
ALTER TABLE public.isle_crop OWNER TO spiritking;
REVOKE ALL ON TABLE "isle_crop" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_crop" TO "spiritking";
ALTER TABLE public.isle_crop_enchants OWNER TO spiritking;
REVOKE ALL ON TABLE "isle_crop_enchants" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_crop_enchants" TO "spiritking";
GRANT ALL(id) ON "isle_crop" TO "spiritking" WITH GRANT OPTION;

version 1202171555
ALTER TABLE player_luckystar ADD normal_type integer;
ALTER TABLE player_luckystar ALTER normal_type SET DEFAULT 1;

ALTER TABLE server_luckystar ADD current_special integer;
ALTER TABLE server_luckystar ALTER current_special SET DEFAULT 0;
ALTER TABLE server_luckystar ADD last_special integer;
ALTER TABLE server_luckystar ALTER last_special SET DEFAULT 0;

ALTER TABLE server_luckystar_log ADD special_no integer;
ALTER TABLE server_luckystar_log ALTER special_no SET DEFAULT 0;

version 1203061446
DROP TABLE isle_achievement_rank;
CREATE TABLE isle_achievement_rank(isle_id integer PRIMARY KEY, isle_name character varying(32) DEFAULT '', isle_lv integer NOT NULL, visits integer DEFAULT 0, total_visits integer DEFAULT 0, grade integer DEFAULT 0, total_grade integer DEFAULT 0);
DROP INDEX isle_achievement_rank;
ALTER TABLE public.isle_achievement_rank OWNER TO spiritking;
REVOKE ALL ON TABLE isle_achievement_rank FROM PUBLIC;
GRANT ALL ON TABLE isle_achievement_rank TO spiritking;

version 1203201138
ALTER TABLE isle_altar ADD time_limit integer DEFAULT 0;

version 1203211034
ALTER TABLE isle ADD equip_cd integer DEFAULT 0;

version 1203230134
DROP TABLE server_shutdown;
CREATE TABLE server_shutdown (server_id integer NOT NULL, shutdown_time integer NOT NULL);
REVOKE ALL ON TABLE "server_shutdown" FROM "PUBLIC";
GRANT ALL ON TABLE "server_shutdown" TO "spiritking";
GRANT ALL ON TABLE "server_shutdown" TO "postgres";

version 1203281830
ALTER TABLE player_characters ADD lucky_bar_money integer;
ALTER TABLE player_characters ALTER lucky_bar_money SET DEFAULT 0;

version 1204181101
ALTER TABLE battlefield_month ADD pk_grade integer;
ALTER TABLE battlefield_month ALTER pk_grade SET DEFAULT 0;
ALTER TABLE battlefield_month ADD pk_kill_count integer;
ALTER TABLE battlefield_month ALTER pk_kill_count SET DEFAULT 0;
ALTER TABLE battlefield_month ADD pk_join_count integer;
ALTER TABLE battlefield_month ALTER pk_join_count SET DEFAULT 0;
UPDATE battlefield_month SET pk_grade = 0;
UPDATE battlefield_month SET pk_kill_count = 0;
UPDATE battlefield_month SET pk_join_count = 0;

version 1205281140
DROP TABLE isle_farm;
CREATE TABLE isle_farm (isle_id integer NOT NULL, category integer NOT NULL, loc integer NOT NULL, state integer NOT NULL, param integer NOT NULL);
CREATE INDEX isle_farm_index ON isle_farm USING btree (isle_id);
REVOKE ALL ON TABLE "isle_farm" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_farm" TO "spiritking";
GRANT ALL ON TABLE "isle_farm" TO "postgres";

version 1206011822
ALTER TABLE family_battle_registration ADD city integer;
ALTER TABLE family_battle_registration ALTER city SET DEFAULT 1;
UPDATE family_battle_registration SET city = 1;
ALTER TABLE family_battle_championship ADD city integer;
ALTER TABLE family_battle_championship ALTER city SET DEFAULT 1;
UPDATE family_battle_championship SET city = 1;

version 1207031121
ALTER TABLE auction ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE bags ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE collection ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE elf ADD train_type_1 integer DEFAULT 0, ADD train_level_1 integer DEFAULT 0, ADD train_exp_1 integer DEFAULT 0;
ALTER TABLE elf ADD train_type_2 integer DEFAULT 0, ADD train_level_2 integer DEFAULT 0, ADD train_exp_2 integer DEFAULT 0;
ALTER TABLE elf ADD train_type_3 integer DEFAULT 0, ADD train_level_3 integer DEFAULT 0, ADD train_exp_3 integer DEFAULT 0;
ALTER TABLE elf_container ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE equipment ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE family_storage ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE inventory ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE mailitem ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE storage ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD train_type integer DEFAULT 0, ADD train_level integer DEFAULT 0, ADD train_exp integer DEFAULT 0;
ALTER TABLE player_characters ADD eqtrain_item_id integer DEFAULT 0;
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
ALTER TABLE auction ALTER COLUMN class TYPE bigint;
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1207121000
ALTER TABLE player_characters ADD lottery_go_reward_1 integer;
ALTER TABLE player_characters ADD lottery_go_reward_2 integer;
ALTER TABLE player_characters ADD lottery_go_reward_3 integer;
ALTER TABLE player_characters ALTER lottery_go_reward_1 SET DEFAULT 0;
ALTER TABLE player_characters ALTER lottery_go_reward_2 SET DEFAULT 0;
ALTER TABLE player_characters ALTER lottery_go_reward_3 SET DEFAULT 0;

version 1207131410
CREATE TABLE elfinventory (id integer NOT NULL, item_id integer NOT NULL, durability integer NOT NULL, maker character varying(32) DEFAULT ''::character varying, rank integer DEFAULT 0, identify smallint DEFAULT 1, magic smallint DEFAULT 0, embedded_amount integer DEFAULT 0, embedded_id1 integer DEFAULT -1, embedded_id2 integer DEFAULT -1, embedded_id3 integer DEFAULT -1, embedded_id4 integer DEFAULT -1, embedded_id5 integer DEFAULT -1, embedded_id6 integer DEFAULT -1, create_time integer DEFAULT 1, due_date integer DEFAULT 0, container_index integer DEFAULT -1, combo_id integer DEFAULT 0, strengthen integer DEFAULT 0, cur_maxdurability integer DEFAULT 0, bind integer DEFAULT 0, player_id integer NOT NULL, loc integer NOT NULL, lock_pwd character varying(32) DEFAULT '*'::character varying, unlock_time integer DEFAULT 0, extra_combo_id1 integer DEFAULT 0, extra_combo_id2 integer DEFAULT 0, extra_combo_id3 integer DEFAULT 0, extra_combo_id4 integer DEFAULT 0, extra_combo_id5 integer DEFAULT 0, extra_combo_id6 integer DEFAULT 0, witchcraft integer DEFAULT 0, train_type integer DEFAULT 0, train_level integer DEFAULT 0, train_exp integer DEFAULT 0, CONSTRAINT elfinventory_pkey PRIMARY KEY (id));
ALTER TABLE public.elfinventory OWNER TO postgres;
REVOKE ALL ON TABLE elfinventory FROM PUBLIC;
GRANT ALL ON TABLE elfinventory TO spiritking;
CREATE UNIQUE INDEX elfinventory_index ON elfinventory USING btree (player_id, loc, container_index);
CREATE INDEX elfinventory_player_container_index ON elfinventory USING btree (player_id, container_index);
CREATE INDEX elfinventory_player_index ON elfinventory USING btree (player_id);

version 1208230535
CREATE TABLE isle_storage (id integer NOT NULL, item_id integer NOT NULL, durability integer NOT NULL, maker character varying(32) DEFAULT ''::character varying, rank integer DEFAULT 0, identify smallint DEFAULT 1, magic smallint DEFAULT 0, embedded_amount integer DEFAULT 0, embedded_id1 integer DEFAULT -1, embedded_id2 integer DEFAULT -1, embedded_id3 integer DEFAULT -1, embedded_id4 integer DEFAULT -1, embedded_id5 integer DEFAULT -1, embedded_id6 integer DEFAULT -1, create_time integer DEFAULT 1, due_date integer DEFAULT 0, container_index integer DEFAULT -1, combo_id integer DEFAULT 0, strengthen integer DEFAULT 0, cur_maxdurability integer DEFAULT 0, bind integer DEFAULT 0, player_id integer NOT NULL, loc integer NOT NULL, lock_pwd character varying(32) DEFAULT '*'::character varying, unlock_time integer DEFAULT 0, extra_combo_id1 integer DEFAULT 0, extra_combo_id2 integer DEFAULT 0, extra_combo_id3 integer DEFAULT 0, extra_combo_id4 integer DEFAULT 0, extra_combo_id5 integer DEFAULT 0, extra_combo_id6 integer DEFAULT 0, witchcraft integer DEFAULT 0, train_type integer DEFAULT 0, train_level integer DEFAULT 0, train_exp integer DEFAULT 0, CONSTRAINT isle_storage_pkey PRIMARY KEY (id));
ALTER TABLE public.isle_storage OWNER TO postgres;
REVOKE ALL ON TABLE isle_storage FROM PUBLIC;
GRANT ALL ON TABLE isle_storage TO spiritking;
CREATE UNIQUE INDEX isle_storage_index ON isle_storage USING btree (player_id, loc, container_index);
CREATE INDEX isle_storage_player_container_index ON isle_storage USING btree (player_id, container_index);
CREATE INDEX isle_storage_player_index ON isle_storage USING btree (player_id);
ALTER TABLE player_characters ADD isle_bank_duedate_1 integer;
ALTER TABLE player_characters ADD isle_bank_duedate_2 integer;
ALTER TABLE player_characters ADD isle_bank_duedate_3 integer;
ALTER TABLE player_characters ADD isle_bank_duedate_4 integer;
ALTER TABLE player_characters ALTER isle_bank_duedate_1 SET DEFAULT 0;
ALTER TABLE player_characters ALTER isle_bank_duedate_2 SET DEFAULT 0;
ALTER TABLE player_characters ALTER isle_bank_duedate_3 SET DEFAULT 0;
ALTER TABLE player_characters ALTER isle_bank_duedate_4 SET DEFAULT 0;

version 1208301700
ALTER TABLE lover ADD is_married integer DEFAULT 0, ADD mood integer DEFAULT 0;

version 1210011700
ALTER TABLE player_characters ADD collection_ability integer DEFAULT 0;

version 1210311000
ALTER TABLE player_characters ADD postfix varchar(16) DEFAULT '1';
UPDATE player_characters SET postfix = '2' WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30;

ALTER TABLE inventory DROP CONSTRAINT inventory_pkey RESTRICT;
DROP INDEX inventory_index;
DROP INDEX inventory_player_index;
ALTER TABLE inventory RENAME TO inventory1;
ALTER TABLE ONLY inventory1 ADD CONSTRAINT inventory1_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX inventory1_index ON inventory1 USING btree (player_id, container_index, loc);
CREATE TABLE inventory2 (id integer NOT NULL,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT (-1),embedded_id2 integer DEFAULT (-1),embedded_id3 integer DEFAULT (-1),embedded_id4 integer DEFAULT (-1),embedded_id5 integer DEFAULT (-1),embedded_id6 integer DEFAULT (-1),create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT (-1),combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,loc integer NOT NULL,lock_pwd character varying(32) DEFAULT '*'::character varying,unlock_time integer DEFAULT 0,extra_combo_id1 integer DEFAULT 0,extra_combo_id2 integer DEFAULT 0,extra_combo_id3 integer DEFAULT 0,extra_combo_id4 integer DEFAULT 0,extra_combo_id5 integer DEFAULT 0,extra_combo_id6 integer DEFAULT 0,witchcraft integer DEFAULT 0,train_type integer DEFAULT 0,train_level integer DEFAULT 0,train_exp integer DEFAULT 0);
ALTER TABLE public.inventory2 OWNER TO postgres;	
REVOKE ALL ON TABLE inventory2 FROM PUBLIC;
REVOKE ALL ON TABLE inventory2 FROM postgres;
GRANT ALL ON TABLE inventory2 TO postgres;
GRANT ALL ON TABLE inventory2 TO spiritking;
ALTER TABLE ONLY inventory2 ADD CONSTRAINT inventory2_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX inventory2_index ON inventory2 USING btree (player_id, container_index, loc);
INSERT INTO inventory2 (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM inventory1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
DELETE FROM inventory1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
CREATE VIEW inventory (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) AS SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM inventory1 UNION ALL SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM inventory2;

ALTER TABLE storage DROP CONSTRAINT storage_pkey RESTRICT;
DROP INDEX storage_loc_index;
ALTER TABLE storage RENAME TO storage1;
ALTER TABLE ONLY storage1 ADD CONSTRAINT storage1_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX storage1_loc_index ON storage1 USING btree (player_id, container_index, loc);
CREATE TABLE storage2 (id integer NOT NULL,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT (-1),embedded_id2 integer DEFAULT (-1),embedded_id3 integer DEFAULT (-1),embedded_id4 integer DEFAULT (-1),embedded_id5 integer DEFAULT (-1),embedded_id6 integer DEFAULT (-1),create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT (-1),combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,loc integer NOT NULL,lock_pwd character varying(32) DEFAULT '*'::character varying,unlock_time integer DEFAULT 0,extra_combo_id1 integer DEFAULT 0,extra_combo_id2 integer DEFAULT 0,extra_combo_id3 integer DEFAULT 0,extra_combo_id4 integer DEFAULT 0,extra_combo_id5 integer DEFAULT 0,extra_combo_id6 integer DEFAULT 0,witchcraft integer DEFAULT 0,train_type integer DEFAULT 0,train_level integer DEFAULT 0,train_exp integer DEFAULT 0);
ALTER TABLE public.storage2 OWNER TO postgres;	
REVOKE ALL ON TABLE storage2 FROM PUBLIC;
REVOKE ALL ON TABLE storage2 FROM postgres;
GRANT ALL ON TABLE storage2 TO postgres;
GRANT ALL ON TABLE storage2 TO spiritking;
ALTER TABLE ONLY storage2 ADD CONSTRAINT storage2_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX storage2_loc_index ON storage2 USING btree (player_id, container_index, loc);
INSERT INTO storage2 (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM storage1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
DELETE FROM storage1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
CREATE VIEW storage (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) AS SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM storage1 UNION ALL SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM storage2;

ALTER TABLE equipment DROP CONSTRAINT equipment_pkey RESTRICT;
DROP INDEX equipment_loc_index;
ALTER TABLE equipment RENAME TO equipment1;
ALTER TABLE ONLY equipment1 ADD CONSTRAINT equipment1_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX equipment1_loc_index ON equipment1 USING btree (player_id, container_index, loc);
CREATE TABLE equipment2 (id integer NOT NULL,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT (-1),embedded_id2 integer DEFAULT (-1),embedded_id3 integer DEFAULT (-1),embedded_id4 integer DEFAULT (-1),embedded_id5 integer DEFAULT (-1),embedded_id6 integer DEFAULT (-1),create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT (-1),combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,player_id integer NOT NULL,loc integer NOT NULL,lock_pwd character varying(32) DEFAULT '*'::character varying,unlock_time integer DEFAULT 0,extra_combo_id1 integer DEFAULT 0,extra_combo_id2 integer DEFAULT 0,extra_combo_id3 integer DEFAULT 0,extra_combo_id4 integer DEFAULT 0,extra_combo_id5 integer DEFAULT 0,extra_combo_id6 integer DEFAULT 0,witchcraft integer DEFAULT 0,train_type integer DEFAULT 0,train_level integer DEFAULT 0,train_exp integer DEFAULT 0);
ALTER TABLE public.equipment2 OWNER TO postgres;	
REVOKE ALL ON TABLE equipment2 FROM PUBLIC;
REVOKE ALL ON TABLE equipment2 FROM postgres;
GRANT ALL ON TABLE equipment2 TO postgres;
GRANT ALL ON TABLE equipment2 TO spiritking;
ALTER TABLE ONLY equipment2 ADD CONSTRAINT equipment2_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX equipment2_loc_index ON equipment2 USING btree (player_id, container_index, loc);
INSERT INTO equipment2 (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM equipment1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
DELETE FROM equipment1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
CREATE VIEW equipment (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) AS SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM equipment1 UNION ALL SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM equipment2;

ALTER TABLE final_mission_state_v2 DROP CONSTRAINT final_mission_state_v2_index RESTRICT;
DROP INDEX final_mission_state_v2_pi_index;
ALTER TABLE final_mission_state_v2 RENAME TO final_mission_state1;
ALTER TABLE ONLY final_mission_state1 ADD CONSTRAINT final_mission_state1_pkey PRIMARY KEY (player_id, index);
CREATE TABLE final_mission_state2 (player_id integer NOT NULL,index integer NOT NULL,state integer);
ALTER TABLE ONLY final_mission_state2 ADD CONSTRAINT final_mission_state2_pkey PRIMARY KEY (player_id, index);
ALTER TABLE public.final_mission_state2 OWNER TO postgres;	
REVOKE ALL ON TABLE final_mission_state2 FROM PUBLIC;
REVOKE ALL ON TABLE final_mission_state2 FROM postgres;
GRANT ALL ON TABLE final_mission_state2 TO postgres;
GRANT ALL ON TABLE final_mission_state2 TO spiritking;
INSERT INTO final_mission_state2 (player_id,index,state) SELECT player_id,index,state FROM final_mission_state1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
DELETE FROM final_mission_state1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
CREATE VIEW final_mission_state_v2 (player_id,index,state) AS SELECT player_id,index,state FROM final_mission_state1 UNION ALL SELECT player_id,index,state FROM final_mission_state2;

ALTER TABLE player_characters_achievement DROP CONSTRAINT player_characters_achievement_pkey RESTRICT;
ALTER TABLE player_characters_achievement RENAME TO player_characters_achievement1;
ALTER TABLE ONLY player_characters_achievement1 ADD CONSTRAINT player_characters_achievement1_pkey PRIMARY KEY (player_id, achievement_id);
CREATE TABLE player_characters_achievement2 (player_id integer NOT NULL,achievement_id integer NOT NULL,point integer NOT NULL);
ALTER TABLE ONLY player_characters_achievement2 ADD CONSTRAINT player_characters_achievement2_pkey PRIMARY KEY (player_id, achievement_id);
ALTER TABLE public.player_characters_achievement2 OWNER TO postgres;	
REVOKE ALL ON TABLE player_characters_achievement2 FROM PUBLIC;
REVOKE ALL ON TABLE player_characters_achievement2 FROM postgres;
GRANT ALL ON TABLE player_characters_achievement2 TO postgres;
GRANT ALL ON TABLE player_characters_achievement2 TO spiritking;
INSERT INTO player_characters_achievement2 (player_id,achievement_id,point) SELECT player_id,achievement_id,point FROM player_characters_achievement1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
DELETE FROM player_characters_achievement1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
CREATE VIEW player_characters_achievement (player_id,achievement_id,point) AS SELECT player_id,achievement_id,point FROM player_characters_achievement1 UNION ALL SELECT player_id,achievement_id,point FROM player_characters_achievement2;

ALTER TABLE elf DROP CONSTRAINT elf_pkey RESTRICT;
DROP INDEX elf_ci_player_id_index;
DROP INDEX elf_player_index;
ALTER TABLE elf RENAME TO elf1;
ALTER TABLE ONLY elf1 ADD CONSTRAINT elf1_pkey PRIMARY KEY (elf_id);
CREATE UNIQUE INDEX elf1_ci_player_id_index ON elf1 USING btree (elf_id, player_id);
CREATE TABLE elf2 (elf_id integer NOT NULL,player_id integer NOT NULL,template_id integer NOT NULL,name character varying(20) DEFAULT ''::character varying,level integer DEFAULT 1,exp integer DEFAULT 0,familiar integer DEFAULT 0,mood integer DEFAULT 0,energy integer DEFAULT 0,stone_a integer DEFAULT 0,stone_b integer DEFAULT 0,skill_id_1 integer DEFAULT 0,skill_level_1 integer DEFAULT 0,skill_exp_1 integer DEFAULT 0,skill_id_2 integer DEFAULT 0,skill_level_2 integer DEFAULT 0,skill_exp_2 integer DEFAULT 0,skill_id_3 integer DEFAULT 0,skill_level_3 integer DEFAULT 0,skill_exp_3 integer DEFAULT 0,skill_id_4 integer DEFAULT 0,skill_level_4 integer DEFAULT 0,skill_exp_4 integer DEFAULT 0,loc smallint NOT NULL,item1 integer DEFAULT 0,amount1 integer DEFAULT 0,socket_amount1 integer DEFAULT 0,item2 integer DEFAULT 0,amount2 integer DEFAULT 0,socket_amount2 integer DEFAULT 0,item3 integer DEFAULT 0,amount3 integer DEFAULT 0,socket_amount3 integer DEFAULT 0,work_type integer DEFAULT 0,work_id integer DEFAULT 0,work_event integer DEFAULT 0,work_count integer DEFAULT 1,face integer DEFAULT 0,type integer DEFAULT 0,skin integer DEFAULT 0,return_loc integer DEFAULT 0,return_grade integer DEFAULT 0,wall integer DEFAULT 0,ground integer DEFAULT 0,game_win integer DEFAULT 0,game_lose integer DEFAULT 0,game_ko integer DEFAULT 0,game_winmsg character varying(32) DEFAULT ''::character varying,game_jan_al smallint DEFAULT 1,game_ken_al smallint DEFAULT 1,game_pon_al smallint DEFAULT 1,game_jan_dl smallint DEFAULT 1,game_ken_dl smallint DEFAULT 1,game_pon_dl smallint DEFAULT 1,game_jan_ae integer DEFAULT 0,game_ken_ae integer DEFAULT 0,game_pon_ae integer DEFAULT 0,game_jan_de integer DEFAULT 0,game_ken_de integer DEFAULT 0,game_pon_de integer DEFAULT 0,combo1 integer DEFAULT 0,combo2 integer DEFAULT 0,combo3 integer DEFAULT 0,extra_combo1_1 integer DEFAULT 0,extra_combo1_2 integer DEFAULT 0,extra_combo1_3 integer DEFAULT 0,extra_combo1_4 integer DEFAULT 0,extra_combo1_5 integer DEFAULT 0,extra_combo1_6 integer DEFAULT 0,extra_combo2_1 integer DEFAULT 0,extra_combo2_2 integer DEFAULT 0,extra_combo2_3 integer DEFAULT 0,extra_combo2_4 integer DEFAULT 0,extra_combo2_5 integer DEFAULT 0,extra_combo2_6 integer DEFAULT 0,extra_combo3_1 integer DEFAULT 0,extra_combo3_2 integer DEFAULT 0,extra_combo3_3 integer DEFAULT 0,extra_combo3_4 integer DEFAULT 0,extra_combo3_5 integer DEFAULT 0,extra_combo3_6 integer DEFAULT 0,game_jan_count integer DEFAULT 0,game_ken_count integer DEFAULT 0,game_pon_count integer DEFAULT 0,gold1 integer DEFAULT 0,gold2 integer DEFAULT 0,gold3 integer DEFAULT 0,witchcraft1 integer DEFAULT 0,witchcraft2 integer DEFAULT 0,witchcraft3 integer DEFAULT 0,strengthen1 integer DEFAULT 0,strengthen2 integer DEFAULT 0,strengthen3 integer DEFAULT 0,embedded1_1 integer DEFAULT (-1),embedded1_2 integer DEFAULT (-1),embedded1_3 integer DEFAULT (-1),embedded1_4 integer DEFAULT (-1),embedded1_5 integer DEFAULT (-1),embedded1_6 integer DEFAULT (-1),embedded2_1 integer DEFAULT (-1),embedded2_2 integer DEFAULT (-1),embedded2_3 integer DEFAULT (-1),embedded2_4 integer DEFAULT (-1),embedded2_5 integer DEFAULT (-1),embedded2_6 integer DEFAULT (-1),embedded3_1 integer DEFAULT 0,embedded3_2 integer DEFAULT (-1),embedded3_3 integer DEFAULT (-1),embedded3_4 integer DEFAULT (-1),embedded3_5 integer DEFAULT (-1),embedded3_6 integer DEFAULT (-1),rework integer DEFAULT 0,max_durability1 integer DEFAULT (-1),max_durability2 integer DEFAULT (-1),max_durability3 integer DEFAULT (-1),class_id integer DEFAULT 0,train_type_1 integer DEFAULT 0,train_level_1 integer DEFAULT 0,train_exp_1 integer DEFAULT 0,train_type_2 integer DEFAULT 0,train_level_2 integer DEFAULT 0,train_exp_2 integer DEFAULT 0,train_type_3 integer DEFAULT 0,train_level_3 integer DEFAULT 0,train_exp_3 integer DEFAULT 0);
ALTER TABLE public.elf2 OWNER TO postgres;
REVOKE ALL ON TABLE elf2 FROM PUBLIC;
REVOKE ALL ON TABLE elf2 FROM postgres;
GRANT ALL ON TABLE elf2 TO postgres;
GRANT ALL ON TABLE elf2 TO spiritking;
ALTER TABLE ONLY elf2 ADD CONSTRAINT elf2_pkey PRIMARY KEY (elf_id);
CREATE UNIQUE INDEX elf2_ci_player_id_index ON elf2 USING btree (elf_id, player_id);
INSERT INTO elf2 (elf_id,player_id,template_id,name,level,exp,familiar,mood,energy,stone_a,stone_b,skill_id_1,skill_level_1,skill_exp_1,skill_id_2,skill_level_2,skill_exp_2,skill_id_3,skill_level_3,skill_exp_3,skill_id_4,skill_level_4,skill_exp_4,loc,item1,amount1,socket_amount1,item2,amount2,socket_amount2,item3,amount3,socket_amount3,work_type,work_id,work_event,work_count,face,type,skin,return_loc,return_grade,wall,ground,game_win,game_lose,game_ko,game_winmsg,game_jan_al,game_ken_al,game_pon_al,game_jan_dl,game_ken_dl,game_pon_dl,game_jan_ae,game_ken_ae,game_pon_ae,game_jan_de,game_ken_de,game_pon_de,combo1,combo2,combo3,extra_combo1_1,extra_combo1_2,extra_combo1_3,extra_combo1_4,extra_combo1_5,extra_combo1_6,extra_combo2_1,extra_combo2_2,extra_combo2_3,extra_combo2_4,extra_combo2_5,extra_combo2_6,extra_combo3_1,extra_combo3_2,extra_combo3_3,extra_combo3_4,extra_combo3_5,extra_combo3_6,game_jan_count,game_ken_count,game_pon_count,gold1,gold2,gold3,witchcraft1,witchcraft2,witchcraft3,strengthen1,strengthen2,strengthen3,embedded1_1,embedded1_2,embedded1_3,embedded1_4,embedded1_5,embedded1_6,embedded2_1,embedded2_2,embedded2_3,embedded2_4,embedded2_5,embedded2_6,embedded3_1,embedded3_2,embedded3_3,embedded3_4,embedded3_5,embedded3_6,rework,max_durability1,max_durability2,max_durability3,class_id,train_type_1,train_level_1,train_exp_1,train_type_2,train_level_2,train_exp_2,train_type_3,train_level_3,train_exp_3) SELECT elf_id,player_id,template_id,name,level,exp,familiar,mood,energy,stone_a,stone_b,skill_id_1,skill_level_1,skill_exp_1,skill_id_2,skill_level_2,skill_exp_2,skill_id_3,skill_level_3,skill_exp_3,skill_id_4,skill_level_4,skill_exp_4,loc,item1,amount1,socket_amount1,item2,amount2,socket_amount2,item3,amount3,socket_amount3,work_type,work_id,work_event,work_count,face,type,skin,return_loc,return_grade,wall,ground,game_win,game_lose,game_ko,game_winmsg,game_jan_al,game_ken_al,game_pon_al,game_jan_dl,game_ken_dl,game_pon_dl,game_jan_ae,game_ken_ae,game_pon_ae,game_jan_de,game_ken_de,game_pon_de,combo1,combo2,combo3,extra_combo1_1,extra_combo1_2,extra_combo1_3,extra_combo1_4,extra_combo1_5,extra_combo1_6,extra_combo2_1,extra_combo2_2,extra_combo2_3,extra_combo2_4,extra_combo2_5,extra_combo2_6,extra_combo3_1,extra_combo3_2,extra_combo3_3,extra_combo3_4,extra_combo3_5,extra_combo3_6,game_jan_count,game_ken_count,game_pon_count,gold1,gold2,gold3,witchcraft1,witchcraft2,witchcraft3,strengthen1,strengthen2,strengthen3,embedded1_1,embedded1_2,embedded1_3,embedded1_4,embedded1_5,embedded1_6,embedded2_1,embedded2_2,embedded2_3,embedded2_4,embedded2_5,embedded2_6,embedded3_1,embedded3_2,embedded3_3,embedded3_4,embedded3_5,embedded3_6,rework,max_durability1,max_durability2,max_durability3,class_id,train_type_1,train_level_1,train_exp_1,train_type_2,train_level_2,train_exp_2,train_type_3,train_level_3,train_exp_3 FROM elf1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
DELETE FROM elf1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
CREATE VIEW elf (elf_id,player_id,template_id,name,level,exp,familiar,mood,energy,stone_a,stone_b,skill_id_1,skill_level_1,skill_exp_1,skill_id_2,skill_level_2,skill_exp_2,skill_id_3,skill_level_3,skill_exp_3,skill_id_4,skill_level_4,skill_exp_4,loc,item1,amount1,socket_amount1,item2,amount2,socket_amount2,item3,amount3,socket_amount3,work_type,work_id,work_event,work_count,face,type,skin,return_loc,return_grade,wall,ground,game_win,game_lose,game_ko,game_winmsg,game_jan_al,game_ken_al,game_pon_al,game_jan_dl,game_ken_dl,game_pon_dl,game_jan_ae,game_ken_ae,game_pon_ae,game_jan_de,game_ken_de,game_pon_de,combo1,combo2,combo3,extra_combo1_1,extra_combo1_2,extra_combo1_3,extra_combo1_4,extra_combo1_5,extra_combo1_6,extra_combo2_1,extra_combo2_2,extra_combo2_3,extra_combo2_4,extra_combo2_5,extra_combo2_6,extra_combo3_1,extra_combo3_2,extra_combo3_3,extra_combo3_4,extra_combo3_5,extra_combo3_6,game_jan_count,game_ken_count,game_pon_count,gold1,gold2,gold3,witchcraft1,witchcraft2,witchcraft3,strengthen1,strengthen2,strengthen3,embedded1_1,embedded1_2,embedded1_3,embedded1_4,embedded1_5,embedded1_6,embedded2_1,embedded2_2,embedded2_3,embedded2_4,embedded2_5,embedded2_6,embedded3_1,embedded3_2,embedded3_3,embedded3_4,embedded3_5,embedded3_6,rework,max_durability1,max_durability2,max_durability3,class_id,train_type_1,train_level_1,train_exp_1,train_type_2,train_level_2,train_exp_2,train_type_3,train_level_3,train_exp_3) AS SELECT elf_id,player_id,template_id,name,level,exp,familiar,mood,energy,stone_a,stone_b,skill_id_1,skill_level_1,skill_exp_1,skill_id_2,skill_level_2,skill_exp_2,skill_id_3,skill_level_3,skill_exp_3,skill_id_4,skill_level_4,skill_exp_4,loc,item1,amount1,socket_amount1,item2,amount2,socket_amount2,item3,amount3,socket_amount3,work_type,work_id,work_event,work_count,face,type,skin,return_loc,return_grade,wall,ground,game_win,game_lose,game_ko,game_winmsg,game_jan_al,game_ken_al,game_pon_al,game_jan_dl,game_ken_dl,game_pon_dl,game_jan_ae,game_ken_ae,game_pon_ae,game_jan_de,game_ken_de,game_pon_de,combo1,combo2,combo3,extra_combo1_1,extra_combo1_2,extra_combo1_3,extra_combo1_4,extra_combo1_5,extra_combo1_6,extra_combo2_1,extra_combo2_2,extra_combo2_3,extra_combo2_4,extra_combo2_5,extra_combo2_6,extra_combo3_1,extra_combo3_2,extra_combo3_3,extra_combo3_4,extra_combo3_5,extra_combo3_6,game_jan_count,game_ken_count,game_pon_count,gold1,gold2,gold3,witchcraft1,witchcraft2,witchcraft3,strengthen1,strengthen2,strengthen3,embedded1_1,embedded1_2,embedded1_3,embedded1_4,embedded1_5,embedded1_6,embedded2_1,embedded2_2,embedded2_3,embedded2_4,embedded2_5,embedded2_6,embedded3_1,embedded3_2,embedded3_3,embedded3_4,embedded3_5,embedded3_6,rework,max_durability1,max_durability2,max_durability3,class_id,train_type_1,train_level_1,train_exp_1,train_type_2,train_level_2,train_exp_2,train_type_3,train_level_3,train_exp_3 FROM elf1 UNION ALL SELECT elf_id,player_id,template_id,name,level,exp,familiar,mood,energy,stone_a,stone_b,skill_id_1,skill_level_1,skill_exp_1,skill_id_2,skill_level_2,skill_exp_2,skill_id_3,skill_level_3,skill_exp_3,skill_id_4,skill_level_4,skill_exp_4,loc,item1,amount1,socket_amount1,item2,amount2,socket_amount2,item3,amount3,socket_amount3,work_type,work_id,work_event,work_count,face,type,skin,return_loc,return_grade,wall,ground,game_win,game_lose,game_ko,game_winmsg,game_jan_al,game_ken_al,game_pon_al,game_jan_dl,game_ken_dl,game_pon_dl,game_jan_ae,game_ken_ae,game_pon_ae,game_jan_de,game_ken_de,game_pon_de,combo1,combo2,combo3,extra_combo1_1,extra_combo1_2,extra_combo1_3,extra_combo1_4,extra_combo1_5,extra_combo1_6,extra_combo2_1,extra_combo2_2,extra_combo2_3,extra_combo2_4,extra_combo2_5,extra_combo2_6,extra_combo3_1,extra_combo3_2,extra_combo3_3,extra_combo3_4,extra_combo3_5,extra_combo3_6,game_jan_count,game_ken_count,game_pon_count,gold1,gold2,gold3,witchcraft1,witchcraft2,witchcraft3,strengthen1,strengthen2,strengthen3,embedded1_1,embedded1_2,embedded1_3,embedded1_4,embedded1_5,embedded1_6,embedded2_1,embedded2_2,embedded2_3,embedded2_4,embedded2_5,embedded2_6,embedded3_1,embedded3_2,embedded3_3,embedded3_4,embedded3_5,embedded3_6,rework,max_durability1,max_durability2,max_durability3,class_id,train_type_1,train_level_1,train_exp_1,train_type_2,train_level_2,train_exp_2,train_type_3,train_level_3,train_exp_3 FROM elf2;

ALTER TABLE elf_container DROP CONSTRAINT elf_container_pkey RESTRICT;
DROP INDEX elf_container_con_index;
DROP INDEX elf_container_loc_index;
ALTER TABLE elf_container RENAME TO elf_container1;
ALTER TABLE ONLY elf_container1 ADD CONSTRAINT elf_container1_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX elf_container1_loc_index ON elf_container1 USING btree (elf_id, loc);
CREATE INDEX elf_container1_con_index ON elf_container1 USING btree (player_id, container_index);
CREATE TABLE elf_container2 (id integer NOT NULL,item_id integer NOT NULL,durability integer NOT NULL,maker character varying(32) DEFAULT ''::character varying,rank integer DEFAULT 0,identify smallint DEFAULT 1,magic smallint DEFAULT 0,embedded_amount integer DEFAULT 0,embedded_id1 integer DEFAULT (-1),embedded_id2 integer DEFAULT (-1),embedded_id3 integer DEFAULT (-1),embedded_id4 integer DEFAULT (-1),embedded_id5 integer DEFAULT (-1),embedded_id6 integer DEFAULT (-1),create_time integer DEFAULT 1,due_date integer DEFAULT 0,container_index integer DEFAULT (-1),combo_id integer DEFAULT 0,strengthen integer DEFAULT 0,cur_maxdurability integer DEFAULT 0,bind integer DEFAULT 0,elf_id integer NOT NULL,player_id integer NOT NULL,loc integer NOT NULL,lock_pwd character varying(32) DEFAULT '*'::character varying,unlock_time integer DEFAULT 0,extra_combo_id1 integer DEFAULT 0,extra_combo_id2 integer DEFAULT 0,extra_combo_id3 integer DEFAULT 0,extra_combo_id4 integer DEFAULT 0,extra_combo_id5 integer DEFAULT 0,extra_combo_id6 integer DEFAULT 0,witchcraft integer DEFAULT 0,train_type integer DEFAULT 0,train_level integer DEFAULT 0,train_exp integer DEFAULT 0);
ALTER TABLE public.elf_container2 OWNER TO postgres;	
REVOKE ALL ON TABLE elf_container2 FROM PUBLIC;
REVOKE ALL ON TABLE elf_container2 FROM postgres;
GRANT ALL ON TABLE elf_container2 TO postgres;
GRANT ALL ON TABLE elf_container2 TO spiritking;
ALTER TABLE ONLY elf_container2 ADD CONSTRAINT elf_container2_pkey PRIMARY KEY (id);
CREATE UNIQUE INDEX elf_container2_loc_index ON elf_container2 USING btree (elf_id, loc);
CREATE INDEX elf_container2_con_index ON elf_container2 USING btree (player_id, container_index);
INSERT INTO elf_container2 (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,elf_id,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,elf_id,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM elf_container1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
DELETE FROM elf_container1 WHERE player_id IN (SELECT id FROM player_characters WHERE last_saving_time < EXTRACT(EPOCH FROM date_trunc('day', now())) - 86400*30);
CREATE VIEW elf_container (id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,elf_id,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp) AS SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,bind,elf_id,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM elf_container1 UNION ALL SELECT id,item_id,durability,maker,rank,identify,magic,embedded_amount,embedded_id1,embedded_id2,embedded_id3,embedded_id4,embedded_id5,embedded_id6,create_time,due_date,container_index,combo_id,strengthen,cur_maxdurability,elf_id,bind,player_id,loc,lock_pwd,unlock_time,extra_combo_id1,extra_combo_id2,extra_combo_id3,extra_combo_id4,extra_combo_id5,extra_combo_id6,witchcraft,train_type,train_level,train_exp FROM elf_container2;

version 1211071000
ALTER TABLE player_characters ADD guess_point integer DEFAULT 0;
ALTER TABLE player_characters ADD guess_answers integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD guess_point integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD history_guess_point integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD guess_answers integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD history_guess_answers integer DEFAULT 0;

version 1212281610
ALTER TABLE player_mail ALTER COLUMN gold TYPE bigint;
ALTER TABLE player_characters ALTER COLUMN gold TYPE bigint;
ALTER TABLE sys_mail_queue_new ALTER COLUMN gold TYPE bigint;
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
ALTER TABLE auction ALTER COLUMN auction_price TYPE bigint;
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1303181002
ALTER TABLE player_characters ADD recommended_events_lv integer DEFAULT 0;
ALTER TABLE player_characters ADD recommended_events_star integer DEFAULT 0;
ALTER TABLE player_characters ADD re_star_buy_count integer DEFAULT 0;
ALTER TABLE player_characters ADD re_reward_id integer DEFAULT 0;

version 1304031000
ALTER TABLE player_characters ADD ride_train_item_id integer DEFAULT 0;

version 1304181000
ALTER TABLE serverstatus ADD bf_count integer;
ALTER TABLE serverstatus ALTER bf_count SET DEFAULT 0;
UPDATE serverstatus SET bf_count = 0;

version 1304301000
ALTER TABLE isle ADD change_name integer;
ALTER TABLE isle ALTER change_name SET DEFAULT 0;
UPDATE isle SET change_name = 0;

version 1305031520
ALTER TABLE player_characters ADD gladiator_last_update_time integer DEFAULT 0;
ALTER TABLE player_characters ADD gladiator_count integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD gladiator_win_count integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD gladiator_lose_count integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD gladiator_win_rate integer DEFAULT 0;
ALTER TABLE player_achievement_rank ADD gladiator_ko_count integer DEFAULT 0;

version 1305061500
DROP TABLE elf_skills;
CREATE TABLE elf_skills (player_id integer NOT NULL, exp_1 integer DEFAULT 0, exp_2 integer DEFAULT 0, exp_3 integer DEFAULT 0, point_1 integer DEFAULT 0, point_2 integer DEFAULT 0, point_3 integer DEFAULT 0, skill_1_1 integer DEFAULT 0, skill_1_2 integer DEFAULT 0, skill_1_3 integer DEFAULT 0, skill_1_4 integer DEFAULT 0, skill_1_5 integer DEFAULT 0, skill_2_1 integer DEFAULT 0, skill_2_2 integer DEFAULT 0, skill_2_3 integer DEFAULT 0, skill_2_4 integer DEFAULT 0, skill_2_5 integer DEFAULT 0, skill_3_1 integer DEFAULT 0, skill_3_2 integer DEFAULT 0, skill_3_3 integer DEFAULT 0, skill_3_4 integer DEFAULT 0, skill_3_5 integer DEFAULT 0);
CREATE INDEX elf_skills_index ON elf_skills USING btree (player_id);
REVOKE ALL ON TABLE "elf_skills" FROM "PUBLIC";
GRANT ALL ON TABLE "elf_skills" TO "spiritking";
GRANT ALL ON TABLE "elf_skills" TO "postgres";
DROP TABLE elf_shortcut_menu;
CREATE TABLE elf_shortcut_menu (player_id integer NOT NULL, index_1 integer DEFAULT 0, index_2 integer DEFAULT 0, index_3 integer DEFAULT 0, index_4 integer DEFAULT 0, index_5 integer DEFAULT 0, dudate_4 integer DEFAULT 0, dudate_5 integer DEFAULT 0);
CREATE INDEX elf_shortcut_menu_index ON elf_shortcut_menu USING btree (player_id);
REVOKE ALL ON TABLE "elf_shortcut_menu" FROM "PUBLIC";
GRANT ALL ON TABLE "elf_shortcut_menu" TO "spiritking";
GRANT ALL ON TABLE "elf_shortcut_menu" TO "postgres";

version 1305271000
ALTER TABLE player_achievement_rank ADD event_six integer;
ALTER TABLE player_achievement_rank ALTER event_six SET DEFAULT 0;
UPDATE player_achievement_rank SET event_six = 0;
ALTER TABLE family_achievement_rank ADD event_six integer;
ALTER TABLE family_achievement_rank ALTER event_six SET DEFAULT 0;
UPDATE family_achievement_rank SET event_six = 0;
ALTER TABLE family_battle_rank ADD event_six integer;
ALTER TABLE family_battle_rank ALTER event_six SET DEFAULT 0;
UPDATE family_battle_rank SET event_six = 0;

version 1305281100
ALTER TABLE personal_mission_states ALTER COLUMN index TYPE bigint;

version 1306202010
ALTER TABLE player_achievement_rank ADD anecdotes_chaslot integer;
ALTER TABLE player_achievement_rank ALTER anecdotes_chaslot SET DEFAULT 0;
UPDATE player_achievement_rank SET anecdotes_chaslot = 0;
ALTER TABLE player_achievement_rank ADD anecdotes_elia integer;
ALTER TABLE player_achievement_rank ALTER anecdotes_elia SET DEFAULT 0;
UPDATE player_achievement_rank SET anecdotes_elia = 0;
ALTER TABLE player_achievement_rank ADD anecdotes_gear integer;
ALTER TABLE player_achievement_rank ALTER anecdotes_gear SET DEFAULT 0;
UPDATE player_achievement_rank SET anecdotes_gear = 0;
ALTER TABLE player_achievement_rank ADD anecdotes_arsalan integer;
ALTER TABLE player_achievement_rank ALTER anecdotes_arsalan SET DEFAULT 0;
UPDATE player_achievement_rank SET anecdotes_arsalan = 0;
ALTER TABLE player_achievement_rank ADD anecdotes_bluewhale integer;
ALTER TABLE player_achievement_rank ALTER anecdotes_bluewhale SET DEFAULT 0;
UPDATE player_achievement_rank SET anecdotes_bluewhale = 0;
ALTER TABLE player_achievement_rank ADD anecdotes_deep integer;
ALTER TABLE player_achievement_rank ALTER anecdotes_deep SET DEFAULT 0;
UPDATE player_achievement_rank SET anecdotes_deep = 0;
ALTER TABLE player_achievement_rank ADD anecdotes_other integer;
ALTER TABLE player_achievement_rank ALTER anecdotes_other SET DEFAULT 0;
UPDATE player_achievement_rank SET anecdotes_other = 0;

version 1306261715
UPDATE personal_mission_states SET index = 4294967296 + index WHERE index < 0;

version 1306261750
DROP TABLE server_fightking;
CREATE TABLE server_fightking (bonus bigint DEFAULT 0, bonus_pool bigint DEFAULT 0, system_recover bigint DEFAULT 0, last_update_time integer DEFAULT 0, change_count integer DEFAULT 0, fightKing_id integer DEFAULT 0, fightking_elf_name character varying (32) DEFAULT '', fightking_elf_template_id integer DEFAULT 0, fightking_elf_model integer DEFAULT 0);
INSERT INTO server_fightking (bonus, bonus_pool, system_recover, last_update_time, change_count, fightKing_id, fightking_elf_name, fightking_elf_template_id, fightking_elf_model) VALUES (0, 0, 0, 0, 0, 0, '', 0, 0);
ALTER TABLE public.server_fightking OWNER TO postgres;
REVOKE ALL ON TABLE server_fightking FROM PUBLIC;
REVOKE ALL ON TABLE server_fightking FROM postgres;
GRANT ALL ON TABLE server_fightking TO postgres;
GRANT ALL ON TABLE server_fightking TO spiritking;

version 1307161730
DROP TABLE fightking;
CREATE TABLE fightking (player_id integer DEFAULT 0, gold bigint DEFAULT 0, CONSTRAINT fightking_pkey PRIMARY KEY (player_id));
ALTER TABLE fightking OWNER TO postgres;
REVOKE ALL ON TABLE fightking FROM PUBLIC;
GRANT ALL ON TABLE fightking TO spiritking;

version 1307171600
DROP TABLE race_team;
DROP TABLE race_team_member;
DROP TABLE race_team_request;
DROP TABLE race_team_record;
DROP TABLE race_record;
CREATE TABLE race_team (id SERIAL, name character varying(32) NOT NULL, leader integer NOT NULL, bulletin character varying(128) DEFAULT '', create_date integer NOT NULL, race_count integer DEFAULT 0, recruit integer DEFAULT 0, class_filter bigint DEFAULT -1, min_level integer DEFAULT 0, max_level integer DEFAULT 0, last_date integer DEFAULT 0, CONSTRAINT race_team_pkey PRIMARY KEY (id));
CREATE INDEX race_team_name_index ON race_team USING btree (name);
ALTER TABLE public.race_team OWNER TO spiritking;
REVOKE ALL ON TABLE "race_team" FROM "PUBLIC";
GRANT ALL ON TABLE "race_team" TO "spiritking";
GRANT ALL(id) ON "race_team" TO "spiritking" WITH GRANT OPTION;
CREATE TABLE race_team_member (team_id integer NOT NULL, player_id integer NOT NULL, flag integer DEFAULT 0, join_date integer NOT NULL);
CREATE INDEX race_team_member_index ON race_team_member USING btree (team_id);
REVOKE ALL ON TABLE "race_team_member" FROM "PUBLIC";
GRANT ALL ON TABLE "race_team_member" TO "spiritking";
GRANT ALL ON TABLE "race_team_member" TO "postgres";
CREATE TABLE race_team_request (team_id integer NOT NULL, player_id integer NOT NULL, name character varying(32) NOT NULL, class_id integer NOT NULL, level integer NOT NULL, request_date integer NOT NULL);
CREATE INDEX race_team_request_index ON race_team_request USING btree (team_id);
REVOKE ALL ON TABLE "race_team_request" FROM "PUBLIC";
GRANT ALL ON TABLE "race_team_request" TO "spiritking";
GRANT ALL ON TABLE "race_team_request" TO "postgres";
CREATE TABLE race_team_record (team_id integer NOT NULL, race_id integer NOT NULL, race_count integer DEFAULT 0, month_best_time integer NOT NULL, best_time integer NOT NULL, record_date integer NOT NULL);
CREATE INDEX race_team_record_index ON race_team_record USING btree (team_id);
REVOKE ALL ON TABLE "race_team_record" FROM "PUBLIC";
GRANT ALL ON TABLE "race_team_record" TO "spiritking";
GRANT ALL ON TABLE "race_team_record" TO "postgres";
CREATE TABLE race_record (player_id integer NOT NULL, race_id integer NOT NULL, month_best_time integer NOT NULL, best_time integer NOT NULL, record_date integer NOT NULL);
CREATE INDEX race_record_index ON race_record USING btree (player_id);
REVOKE ALL ON TABLE "race_record" FROM "PUBLIC";
GRANT ALL ON TABLE "race_record" TO "spiritking";
GRANT ALL ON TABLE "race_record" TO "postgres";
ALTER TABLE player_characters ADD race_team_id integer DEFAULT 0;
ALTER TABLE player_characters ADD interim_race_team_id integer DEFAULT 0;
UPDATE player_characters SET race_team_id = 0;
UPDATE player_characters SET interim_race_team_id = 0;

version 1307252000
DROP TABLE race_team_rank;
DROP TABLE race_rank;
CREATE TABLE race_team_rank (group_id integer NOT NULL, team_id integer NOT NULL, team_name character varying(32) NOT NULL, team_declare character varying(128) NOT NULL, last_date integer DEFAULT 0, race_id_1 integer DEFAULT 0, race_count_1 integer DEFAULT 0, race_record_1 integer DEFAULT 0, race_id_2 integer DEFAULT 0, race_count_2 integer DEFAULT 0, race_record_2 integer DEFAULT 0, race_id_3 integer DEFAULT 0, race_count_3 integer DEFAULT 0, race_record_3 integer DEFAULT 0, race_id_4 integer DEFAULT 0, race_count_4 integer DEFAULT 0, race_record_4 integer DEFAULT 0, race_id_5 integer DEFAULT 0, race_count_5 integer DEFAULT 0, race_record_5 integer DEFAULT 0, race_id_6 integer DEFAULT 0, race_count_6 integer DEFAULT 0, race_record_6 integer DEFAULT 0, race_id_7 integer DEFAULT 0, race_count_7 integer DEFAULT 0, race_record_7 integer DEFAULT 0, race_id_8 integer DEFAULT 0, race_count_8 integer DEFAULT 0, race_record_8 integer DEFAULT 0, race_id_9 integer DEFAULT 0, race_count_9 integer DEFAULT 0, race_record_9 integer DEFAULT 0, race_id_10 integer DEFAULT 0, race_count_10 integer DEFAULT 0, race_record_10 integer DEFAULT 0);
CREATE INDEX race_team_rank_group_id_index ON race_team_rank USING btree (group_id);
REVOKE ALL ON TABLE "race_team_rank" FROM "PUBLIC";
GRANT ALL ON TABLE "race_team_rank" TO "spiritking";
GRANT ALL ON TABLE "race_team_rank" TO "postgres";
CREATE TABLE race_rank (race_id integer NOT NULL, player_id integer NOT NULL, player_name character varying(32) NOT NULL, family_name character varying(32) NOT NULL, class_id integer DEFAULT 0, level integer DEFAULT 0, last_date integer DEFAULT 0, race_record integer DEFAULT 0, race_best_record integer DEFAULT 0);
CREATE INDEX race_rank_id_index ON race_rank USING btree (race_id);
REVOKE ALL ON TABLE "race_rank" FROM "PUBLIC";
GRANT ALL ON TABLE "race_rank" TO "spiritking";
GRANT ALL ON TABLE "race_rank" TO "postgres";

version 1307252100
ALTER TABLE serverstatus ADD last_race_reset_time integer;
ALTER TABLE serverstatus ALTER last_race_reset_time SET DEFAULT 0;
UPDATE serverstatus SET last_race_reset_time = 0;

version 1307302000
ALTER TABLE public.race_rank OWNER TO spiritking;
ALTER TABLE public.race_team_rank OWNER TO spiritking;

version 1308221500
ALTER TABLE player_characters ADD arena_point integer DEFAULT 0;

version 1310142000
ALTER TABLE elf1 ADD to_bind1 integer;
ALTER TABLE elf1 ALTER to_bind1 SET DEFAULT 0;
UPDATE elf1 SET to_bind1 = 0;
ALTER TABLE elf1 ADD to_bind2 integer;
ALTER TABLE elf1 ALTER to_bind2 SET DEFAULT 0;
UPDATE elf1 SET to_bind2 = 0;
ALTER TABLE elf1 ADD to_bind3 integer;
ALTER TABLE elf1 ALTER to_bind3 SET DEFAULT 0;
UPDATE elf1 SET to_bind3 = 0;
ALTER TABLE elf2 ADD to_bind1 integer;
ALTER TABLE elf2 ALTER to_bind1 SET DEFAULT 0;
UPDATE elf2 SET to_bind1 = 0;
ALTER TABLE elf2 ADD to_bind2 integer;
ALTER TABLE elf2 ALTER to_bind2 SET DEFAULT 0;
UPDATE elf2 SET to_bind2 = 0;
ALTER TABLE elf2 ADD to_bind3 integer;
ALTER TABLE elf2 ALTER to_bind3 SET DEFAULT 0;
UPDATE elf2 SET to_bind3 = 0;

version 1312241200
ALTER TABLE player_characters ADD upanishad_1 integer DEFAULT 0;
ALTER TABLE player_characters ADD upanishad_2 integer DEFAULT 0;
ALTER TABLE player_characters ADD upanishad_3 integer DEFAULT 0;
ALTER TABLE player_characters ADD upanishad_4 integer DEFAULT 0;
ALTER TABLE player_characters ADD select_upanishad integer DEFAULT 0;

version 1403072000
DROP TABLE daily_awards;
CREATE TABLE daily_awards (id integer NOT NULL, day_index integer DEFAULT 0, cooldown_time integer DEFAULT 0, award_days bigint DEFAULT 0, award_records bigint DEFAULT 0, CONSTRAINT daily_awards_pkey PRIMARY KEY (id));
ALTER TABLE public.daily_awards OWNER TO spiritking;
GRANT ALL ON TABLE "daily_awards" TO "spiritking";
GRANT ALL(id) ON "daily_awards" TO "spiritking" WITH GRANT OPTION;
ALTER TABLE serverstatus ADD daily_awards_time_record integer;
ALTER TABLE serverstatus ALTER daily_awards_time_record SET DEFAULT 0;
UPDATE serverstatus SET daily_awards_time_record = 0;
ALTER TABLE serverstatus ADD daily_awards_begin_date integer;
ALTER TABLE serverstatus ALTER daily_awards_begin_date SET DEFAULT 0;
UPDATE serverstatus SET daily_awards_begin_date = 0;
ALTER TABLE serverstatus ADD daily_awards_flags integer;
ALTER TABLE serverstatus ALTER daily_awards_flags SET DEFAULT 0;
UPDATE serverstatus SET daily_awards_flags = 0;


version 1404021000
ALTER TABLE inventory1 ADD ride_combo integer DEFAULT 0;
ALTER TABLE inventory1 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE inventory1 ADD ride_point integer DEFAULT 0;
ALTER TABLE inventory2 ADD ride_combo integer DEFAULT 0;
ALTER TABLE inventory2 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE inventory2 ADD ride_point integer DEFAULT 0;

ALTER TABLE elfinventory ADD ride_combo integer DEFAULT 0;
ALTER TABLE elfinventory ADD ride_star_level integer DEFAULT 0;
ALTER TABLE elfinventory ADD ride_point integer DEFAULT 0;

ALTER TABLE storage1 ADD ride_combo integer DEFAULT 0;
ALTER TABLE storage1 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE storage1 ADD ride_point integer DEFAULT 0;
ALTER TABLE storage2 ADD ride_combo integer DEFAULT 0;
ALTER TABLE storage2 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE storage2 ADD ride_point integer DEFAULT 0;

ALTER TABLE equipment1 ADD ride_combo integer DEFAULT 0;
ALTER TABLE equipment1 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE equipment1 ADD ride_point integer DEFAULT 0;
ALTER TABLE equipment2 ADD ride_combo integer DEFAULT 0;
ALTER TABLE equipment2 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE equipment2 ADD ride_point integer DEFAULT 0;

ALTER TABLE collection ADD ride_combo integer DEFAULT 0;
ALTER TABLE collection ADD ride_star_level integer DEFAULT 0;
ALTER TABLE collection ADD ride_point integer DEFAULT 0;

ALTER TABLE isle_storage ADD ride_combo integer DEFAULT 0;
ALTER TABLE isle_storage ADD ride_star_level integer DEFAULT 0;
ALTER TABLE isle_storage ADD ride_point integer DEFAULT 0;

ALTER TABLE family_storage ADD ride_combo integer DEFAULT 0;
ALTER TABLE family_storage ADD ride_star_level integer DEFAULT 0;
ALTER TABLE family_storage ADD ride_point integer DEFAULT 0;

ALTER TABLE auction ADD ride_combo integer DEFAULT 0;
ALTER TABLE auction ADD ride_star_level integer DEFAULT 0;
ALTER TABLE auction ADD ride_point integer DEFAULT 0;

ALTER TABLE sys_mail_queue ADD ride_combo integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD ride_star_level integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD ride_point integer DEFAULT 0;

ALTER TABLE sys_mail_queue_new ADD ride_combo integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD ride_star_level integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD ride_point integer DEFAULT 0;

ALTER TABLE mailitem ADD ride_combo integer DEFAULT 0;
ALTER TABLE mailitem ADD ride_star_level integer DEFAULT 0;
ALTER TABLE mailitem ADD ride_point integer DEFAULT 0;

ALTER TABLE elf1 ADD ride_combo1 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_star_level1 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_point1 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_combo2 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_star_level2 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_point2 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_combo3 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_star_level3 integer DEFAULT 0;
ALTER TABLE elf1 ADD ride_point3 integer DEFAULT 0;

ALTER TABLE elf2 ADD ride_combo1 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_star_level1 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_point1 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_combo2 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_star_level2 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_point2 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_combo3 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_star_level3 integer DEFAULT 0;
ALTER TABLE elf2 ADD ride_point3 integer DEFAULT 0;

ALTER TABLE elf_container1 ADD ride_combo integer DEFAULT 0;
ALTER TABLE elf_container1 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE elf_container1 ADD ride_point integer DEFAULT 0;
ALTER TABLE elf_container2 ADD ride_combo integer DEFAULT 0;
ALTER TABLE elf_container2 ADD ride_star_level integer DEFAULT 0;
ALTER TABLE elf_container2 ADD ride_point integer DEFAULT 0;

ALTER TABLE bags ADD ride_combo integer DEFAULT 0;
ALTER TABLE bags ADD ride_star_level integer DEFAULT 0;
ALTER TABLE bags ADD ride_point integer DEFAULT 0;

ALTER TABLE player_characters ADD equip_ride_item_id integer DEFAULT 0;

version 1404101400
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1405021005
DROP TABLE isle_elf_works;
CREATE TABLE isle_elf_works (isle_id integer NOT NULL, category integer NOT NULL, elf_1 integer NOT NULL, elf_2 integer NOT NULL, elf_3 integer NOT NULL, elf_4 integer NOT NULL, elf_5 integer NOT NULL, end_time integer NOT NULL);
CREATE INDEX isle_elf_works_index ON isle_elf_works USING btree (isle_id);
REVOKE ALL ON TABLE "isle_elf_works" FROM "PUBLIC";
GRANT ALL ON TABLE "isle_elf_works" TO "spiritking";
GRANT ALL ON TABLE "isle_elf_works" TO "postgres";

version 1405061100
DROP TABLE vip_card;
CREATE TABLE vip_card (player_id integer NOT NULL, vip_id integer NOT NULL, received_day integer NOT NULL, set_time integer NOT NULL, next_time integer NOT NULL, CONSTRAINT vip_card_pkey PRIMARY KEY (player_id));
ALTER TABLE vip_card OWNER TO postgres;
REVOKE ALL ON TABLE vip_card FROM PUBLIC;
GRANT ALL ON TABLE vip_card TO spiritking;

version 1405091500
DROP TABLE player_family_transform;
CREATE TABLE player_family_transform (player_id integer NOT NULL, family_id integer NOT NULL, inviter_id integer NOT NULL, dead_line integer NOT NULL);
ALTER TABLE public.player_family_transform OWNER TO postgres;
CREATE INDEX player_family_transform_index ON player_family_transform USING btree (player_id);
REVOKE ALL ON TABLE player_family_transform FROM PUBLIC;
REVOKE ALL ON TABLE player_family_transform FROM postgres;
GRANT ALL ON TABLE player_family_transform TO postgres;
GRANT ALL ON TABLE player_family_transform TO spiritking;

DROP TABLE family_tree;
CREATE TABLE family_tree (family_id integer NOT NULL, finish_tree_id integer NOT NULL);
ALTER TABLE public.family_tree OWNER TO postgres;
CREATE INDEX family_tree_index ON family_tree USING btree (family_id);
REVOKE ALL ON TABLE family_tree FROM PUBLIC;
REVOKE ALL ON TABLE family_tree FROM postgres;
GRANT ALL ON TABLE family_tree TO postgres;
GRANT ALL ON TABLE family_tree TO spiritking;

ALTER TABLE family ADD tree_privilege integer DEFAULT 1;
ALTER TABLE family ADD tree_level integer DEFAULT 1;
ALTER TABLE family ADD tree_exp integer DEFAULT 0;
ALTER TABLE family ADD tree_energy integer DEFAULT 0;
ALTER TABLE family ADD tree_refresh integer DEFAULT 0;
UPDATE family SET tree_refresh = 1;

version 1406171045
ALTER TABLE player_characters ADD daily_update_time integer DEFAULT 0;
ALTER TABLE player_characters ADD num_hello integer DEFAULT 0;
ALTER TABLE player_characters ADD hello_enable integer DEFAULT 0;
ALTER TABLE player_characters ADD greetings character varying(128) DEFAULT '';

DROP TABLE player_free_ticket;
CREATE TABLE player_free_ticket (account_id integer NOT NULL, free_tickets integer DEFAULT 0, CONSTRAINT player_free_ticket_pkey PRIMARY KEY (account_id));
ALTER TABLE public.player_free_ticket OWNER TO postgres;
REVOKE ALL ON TABLE player_free_ticket FROM PUBLIC;
REVOKE ALL ON TABLE player_free_ticket FROM postgres;
GRANT ALL ON TABLE player_free_ticket TO postgres;
GRANT ALL ON TABLE player_free_ticket TO spiritking;

ALTER TABLE friends ADD hello integer DEFAULT 0;

version 1407171045
DROP INDEX player_characters_deleted_time_index;

version 1409011100
INSERT INTO family_battle_data(area_id, area_name, family_id, week_type) VALUES (4, 'deepfathom', 0, 0); 

version 1410081041
ALTER TABLE player_characters ALTER COLUMN exp TYPE bigint;

version 1410221000
DROP TABLE students;
CREATE TABLE students (player_id integer NOT NULL, student_id integer NOT NULL);
CREATE INDEX students_index ON students USING btree (player_id);
ALTER TABLE students OWNER TO spiritking;
REVOKE ALL ON TABLE students FROM PUBLIC;
GRANT ALL ON TABLE students TO postgres;

DROP TABLE mentorship;
CREATE TABLE mentorship (player_id integer PRIMARY KEY, mentor_rank integer DEFAULT 0, mentor_point integer DEFAULT 0, daily_challenge integer DEFAULT 0, my_mentor_id integer DEFAULT 0, etc_flags integer DEFAULT 0);
ALTER TABLE public.mentorship OWNER TO postgres;
REVOKE ALL ON TABLE mentorship FROM PUBLIC;
REVOKE ALL ON TABLE mentorship FROM postgres;
GRANT ALL ON TABLE mentorship TO postgres;
GRANT ALL ON TABLE mentorship TO spiritking;

version 1410231041
ALTER TABLE player_characters ADD rebirth_count integer DEFAULT 0;
ALTER TABLE player_characters ADD rebirth_score integer DEFAULT 0;
ALTER TABLE player_characters ADD rebirth_last_class integer DEFAULT 0;
ALTER TABLE player_characters ADD rebirth_last_level integer DEFAULT 0;


CREATE TABLE spell_storage (player_id integer NOT NULL, spell_id integer NOT NULL, CONSTRAINT spell_storage_pkey PRIMARY KEY (player_id));
ALTER TABLE public.spell_storage OWNER TO postgres;
REVOKE ALL ON TABLE spell_storage FROM PUBLIC;
REVOKE ALL ON TABLE spell_storage FROM postgres;
GRANT ALL ON TABLE spell_storage TO postgres;
GRANT ALL ON TABLE spell_storage TO spiritking;


version 1412231041
DROP TABLE spell_storage;
CREATE TABLE spell_storage (player_id integer NOT NULL, spell_id integer NOT NULL);
CREATE INDEX spell_storage_index ON spell_storage USING btree (player_id);
ALTER TABLE public.spell_storage OWNER TO postgres;
REVOKE ALL ON TABLE spell_storage FROM PUBLIC;
REVOKE ALL ON TABLE spell_storage FROM postgres;
GRANT ALL ON TABLE spell_storage TO postgres;
GRANT ALL ON TABLE spell_storage TO spiritking;

version 1501281012
ALTER TABLE player_characters ADD rebirth_front_score integer DEFAULT 0;
ALTER TABLE player_characters ADD rebirth_store_exp bigint DEFAULT 0;

version 1502061020
ALTER TABLE player_achievement_rank ADD rebirth_count integer DEFAULT 0;
ALTER TABLE battlefield_month ADD rebirth_count integer DEFAULT 0;
ALTER TABLE race_rank ADD rebirth_count integer DEFAULT 0;
ALTER TABLE player_achievement_rank_old ADD rebirth_count integer DEFAULT 0;
ALTER TABLE battlefield_month_old ADD rebirth_count integer DEFAULT 0;
ALTER TABLE race_rank_old ADD rebirth_count integer DEFAULT 0;
UPDATE player_achievement_rank SET rebirth_count = player_characters.rebirth_count FROM player_characters WHERE player_id = player_characters.id;
UPDATE battlefield_month SET rebirth_count = player_characters.rebirth_count FROM player_characters WHERE player_id = player_characters.id;
UPDATE race_rank SET rebirth_count = player_characters.rebirth_count FROM player_characters WHERE player_id = player_characters.id;
UPDATE player_achievement_rank_old SET rebirth_count = player_characters.rebirth_count FROM player_characters WHERE player_id = player_characters.id;
UPDATE battlefield_month_old SET rebirth_count = player_characters.rebirth_count FROM player_characters WHERE player_id = player_characters.id;
UPDATE race_rank_old SET rebirth_count = player_characters.rebirth_count FROM player_characters WHERE player_id = player_characters.id;

version 1503021100
DELETE FROM students WHERE student_id NOT IN (SELECT player_id FROM mentorship WHERE my_mentor_id > 0);

version 1504071042
ALTER TABLE player_mail ALTER COLUMN sender_name TYPE text;
ALTER TABLE player_mail ALTER COLUMN title TYPE text;
ALTER TABLE sys_mail_queue ALTER COLUMN title TYPE text;
ALTER TABLE statues_scenes ALTER COLUMN player_name TYPE text;
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
ALTER TABLE auction ALTER COLUMN item_name TYPE text;
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1505051140
UPDATE mentorship SET etc_flags = 0 WHERE player_id = (SELECT student_id FROM students WHERE player_id NOT IN (SELECT my_mentor_id FROM mentorship WHERE player_id = students.student_id));
UPDATE mentorship SET etc_flags = 0 WHERE player_id = (SELECT player_id FROM students WHERE player_id NOT IN (SELECT my_mentor_id FROM mentorship WHERE player_id = students.student_id));
DELETE FROM students WHERE player_id NOT IN (SELECT my_mentor_id FROM mentorship WHERE player_id = students.student_id);

version 1506021150
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
ALTER TABLE auction ALTER COLUMN item_name TYPE text;
ALTER TABLE auction ALTER COLUMN lock_pwd TYPE text;
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";
ALTER TABLE bags ALTER COLUMN maker TYPE text;
ALTER TABLE bags ALTER COLUMN lock_pwd TYPE text;
ALTER TABLE battlefield_career ALTER COLUMN player_name TYPE text;
ALTER TABLE battlefield_month ALTER COLUMN player_name TYPE text;
ALTER TABLE collection ALTER COLUMN maker TYPE text;
ALTER TABLE collection ALTER COLUMN lock_pwd TYPE text;
DROP VIEW elf;
ALTER TABLE elf1 ALTER COLUMN name TYPE text;
ALTER TABLE elf2 ALTER COLUMN name TYPE text;
ALTER TABLE elf1 ALTER COLUMN game_winmsg TYPE text;
ALTER TABLE elf2 ALTER COLUMN game_winmsg TYPE text;
CREATE VIEW elf AS SELECT * FROM elf1 UNION ALL SELECT * FROM elf2;
REVOKE ALL on elf from PUBLIC;
GRANT ALL on elf to "postgres";
GRANT ALL on elf to "spiritking";
DROP VIEW elf_container;
ALTER TABLE elf_container1 ALTER COLUMN maker TYPE text;
ALTER TABLE elf_container2 ALTER COLUMN maker TYPE text;
ALTER TABLE elf_container1 ALTER COLUMN lock_pwd TYPE text;
ALTER TABLE elf_container2 ALTER COLUMN lock_pwd TYPE text;
CREATE VIEW elf_container AS SELECT * FROM elf_container1 UNION ALL SELECT * FROM elf_container2;
REVOKE ALL on elf_container from PUBLIC;
GRANT ALL on elf_container to "postgres";
GRANT ALL on elf_container to "spiritking";
ALTER TABLE elfinventory ALTER COLUMN maker TYPE text;
ALTER TABLE elfinventory ALTER COLUMN lock_pwd TYPE text;
DROP VIEW equipment;
ALTER TABLE equipment1 ALTER COLUMN maker TYPE text;
ALTER TABLE equipment2 ALTER COLUMN maker TYPE text;
ALTER TABLE equipment1 ALTER COLUMN lock_pwd TYPE text;
ALTER TABLE equipment2 ALTER COLUMN lock_pwd TYPE text;
CREATE VIEW equipment AS SELECT * FROM equipment1 UNION ALL SELECT * FROM equipment2;
REVOKE ALL on equipment from PUBLIC;
GRANT ALL on equipment to "postgres";
GRANT ALL on equipment to "spiritking";

ALTER TABLE family ALTER COLUMN name TYPE text;
ALTER TABLE family ALTER COLUMN recruit_message TYPE text;
ALTER TABLE family ALTER COLUMN info TYPE text;
ALTER TABLE family ALTER COLUMN member_title TYPE text;
ALTER TABLE family ALTER COLUMN leader_title TYPE text;
ALTER TABLE family ALTER COLUMN cadre_title_2 TYPE text;
ALTER TABLE family ALTER COLUMN cadre_title_3 TYPE text;
ALTER TABLE family ALTER COLUMN cadre_title_4 TYPE text;
ALTER TABLE family ALTER COLUMN cadre_title_5 TYPE text;
ALTER TABLE family ALTER COLUMN cadre_title_6 TYPE text;
ALTER TABLE family ALTER COLUMN cadre_title_7 TYPE text;
ALTER TABLE family ALTER COLUMN cadre_title_8 TYPE text;

ALTER TABLE family_achievement_rank ALTER COLUMN family_name TYPE text;

ALTER TABLE family_battle_championship ALTER COLUMN family_name TYPE text;
ALTER TABLE family_battle_data ALTER COLUMN area_name TYPE text;

ALTER TABLE family_battle_rank ALTER COLUMN family_name TYPE text;

ALTER TABLE family_cadre_members ALTER COLUMN title TYPE text;

ALTER TABLE family_crop ALTER COLUMN grower TYPE text;

ALTER TABLE family_msgboard ALTER COLUMN title TYPE text;
ALTER TABLE family_msgboard ALTER COLUMN content TYPE text;
ALTER TABLE family_msgboard ALTER COLUMN player_name TYPE text;

ALTER TABLE family_storage ALTER COLUMN maker TYPE text;
ALTER TABLE family_storage ALTER COLUMN lock_pwd TYPE text;

ALTER TABLE family_storage_log ALTER COLUMN log TYPE text;

DROP VIEW inventory;
ALTER TABLE inventory1 ALTER COLUMN maker TYPE text;
ALTER TABLE inventory2 ALTER COLUMN maker TYPE text;
ALTER TABLE inventory1 ALTER COLUMN lock_pwd TYPE text;
ALTER TABLE inventory2 ALTER COLUMN lock_pwd TYPE text;
CREATE VIEW inventory AS SELECT * FROM inventory1 UNION ALL SELECT * FROM inventory2;
REVOKE ALL on inventory from PUBLIC;
GRANT ALL on inventory to "postgres";
GRANT ALL on inventory to "spiritking";

ALTER TABLE isle ALTER COLUMN name TYPE text;
ALTER TABLE isle ALTER COLUMN create_date TYPE text;
ALTER TABLE isle ALTER COLUMN bulletin TYPE text;

ALTER TABLE isle_achievement_rank ALTER COLUMN isle_name TYPE text;
ALTER TABLE isle_achievement_rank_old ALTER COLUMN isle_name TYPE text;

ALTER TABLE isle_blacklist ALTER COLUMN block_name TYPE text;

ALTER TABLE isle_crop ALTER COLUMN grower TYPE text;

ALTER TABLE isle_record ALTER COLUMN name TYPE text;

ALTER TABLE isle_storage ALTER COLUMN maker TYPE text;
ALTER TABLE isle_storage ALTER COLUMN lock_pwd TYPE text;

ALTER TABLE lover ALTER COLUMN message TYPE text;

ALTER TABLE mailitem ALTER COLUMN maker TYPE text;
ALTER TABLE mailitem ALTER COLUMN lock_pwd TYPE text;

ALTER TABLE message_board ALTER COLUMN title TYPE text;
ALTER TABLE message_board ALTER COLUMN content TYPE text;
ALTER TABLE message_board ALTER COLUMN player_name TYPE text;

ALTER TABLE player_achievement_rank ALTER COLUMN player_name TYPE text;
ALTER TABLE player_achievement_rank_old ALTER COLUMN player_name TYPE text;

ALTER TABLE player_characters ALTER COLUMN given_name TYPE text;
ALTER TABLE player_characters ALTER COLUMN account_name TYPE text;
ALTER TABLE player_characters ALTER COLUMN self_comment TYPE text;
ALTER TABLE player_characters ALTER COLUMN family_comment TYPE text;
ALTER TABLE player_characters ALTER COLUMN greetings TYPE text;

ALTER TABLE player_luckystar ALTER COLUMN lucky_ticket_str TYPE text;

ALTER TABLE player_mail ALTER COLUMN sender_name TYPE text;
ALTER TABLE player_mail ALTER COLUMN title TYPE text;

ALTER TABLE race_rank ALTER COLUMN player_name TYPE text;
ALTER TABLE race_rank ALTER COLUMN family_name TYPE text;

ALTER TABLE race_team ALTER COLUMN name TYPE text;
ALTER TABLE race_team ALTER COLUMN bulletin TYPE text;

ALTER TABLE race_team_rank ALTER COLUMN team_name TYPE text;
ALTER TABLE race_team_rank ALTER COLUMN team_declare TYPE text;

ALTER TABLE race_team_request ALTER COLUMN name TYPE text;

ALTER TABLE server_fightking ALTER COLUMN fightking_elf_name TYPE text;

ALTER TABLE server_luckystar ALTER COLUMN current_lucky_ticket_str TYPE text;
ALTER TABLE server_luckystar ALTER COLUMN last_lucky_ticket_str TYPE text;

ALTER TABLE server_luckystar_log ALTER COLUMN lucky_ticket_str TYPE text;

ALTER TABLE statues_scenes ALTER COLUMN player_name TYPE text;

DROP VIEW storage;
ALTER TABLE storage1 ALTER COLUMN maker TYPE text;
ALTER TABLE storage2 ALTER COLUMN maker TYPE text;
ALTER TABLE storage1 ALTER COLUMN lock_pwd TYPE text;
ALTER TABLE storage2 ALTER COLUMN lock_pwd TYPE text;
CREATE VIEW storage AS SELECT * FROM storage1 UNION ALL SELECT * FROM storage2;
REVOKE ALL on storage from PUBLIC;
GRANT ALL on storage to "postgres";
GRANT ALL on storage to "spiritking";

ALTER TABLE sys_mail_queue ALTER COLUMN title TYPE text;
ALTER TABLE sys_mail_queue ALTER COLUMN content TYPE text;
ALTER TABLE sys_mail_queue ALTER COLUMN maker TYPE text;
ALTER TABLE sys_mail_queue ALTER COLUMN state TYPE text;
ALTER TABLE sys_mail_queue ALTER COLUMN sender_name TYPE text;

ALTER TABLE sys_mail_queue_new ALTER COLUMN state TYPE text;
ALTER TABLE sys_mail_queue_new ALTER COLUMN sender_name TYPE text;
ALTER TABLE sys_mail_queue_new ALTER COLUMN title TYPE text;
ALTER TABLE sys_mail_queue_new ALTER COLUMN content TYPE text;
ALTER TABLE sys_mail_queue_new ALTER COLUMN maker TYPE text;


version 1506161127
CREATE TABLE new_shortcut_menu (player_id integer NOT NULL, index1 integer DEFAULT -1, index2 integer DEFAULT -1, index3 integer DEFAULT -1, index4 integer DEFAULT -1, index5 integer DEFAULT -1, index6 integer DEFAULT -1, index7 integer DEFAULT -1, index8 integer DEFAULT -1, index9 integer DEFAULT -1, index10 integer DEFAULT -1, index11 integer DEFAULT -1, index12 integer DEFAULT -1, index13 integer DEFAULT -1, index14 integer DEFAULT -1, index15 integer DEFAULT -1, index16 integer DEFAULT -1, index17 integer DEFAULT -1, index18 integer DEFAULT -1, index19 integer DEFAULT -1, index20 integer DEFAULT -1, index21 integer DEFAULT -1, index22 integer DEFAULT -1, index23 integer DEFAULT -1, index24 integer DEFAULT -1, CONSTRAINT new_shortcut_menu_pkey PRIMARY KEY (player_id));
ALTER TABLE public.new_shortcut_menu OWNER TO postgres;
REVOKE ALL ON TABLE new_shortcut_menu FROM PUBLIC;
REVOKE ALL ON TABLE new_shortcut_menu FROM postgres;
GRANT ALL ON TABLE new_shortcut_menu TO postgres;
GRANT ALL ON TABLE new_shortcut_menu TO spiritking;

version 1506222000
DROP TABLE account_shared;
CREATE TABLE account_shared (account_id integer PRIMARY KEY, beaststower_enter_count integer DEFAULT 0);
ALTER TABLE public.account_shared OWNER TO postgres;
REVOKE ALL ON TABLE account_shared FROM PUBLIC;
REVOKE ALL ON TABLE account_shared FROM postgres;
GRANT ALL ON TABLE account_shared TO postgres;
GRANT ALL ON TABLE account_shared TO spiritking;

version 1507160000
DROP TABLE beasts_tower;
DROP TABLE beasts_tower_old;
CREATE TABLE beasts_tower (bt_id integer PRIMARY KEY, floor integer DEFAULT 0, family_id integer DEFAULT 0);
ALTER TABLE public.beasts_tower OWNER TO spiritking;
REVOKE ALL ON TABLE beasts_tower FROM PUBLIC;
GRANT ALL ON TABLE beasts_tower TO postgres;

DROP TABLE beasts_tower_members;
DROP TABLE beasts_tower_members_old;
CREATE TABLE beasts_tower_members (player_id integer PRIMARY KEY, bt_id integer DEFAULT 0);
ALTER TABLE public.beasts_tower_members OWNER TO spiritking;
REVOKE ALL ON TABLE beasts_tower_members FROM PUBLIC;
GRANT ALL ON TABLE beasts_tower_members TO postgres;

version 1507210000
ALTER TABLE account_shared ADD daily_update_time integer DEFAULT 0;

version 1508040003
DROP TABLE beasts_tower;
DROP TABLE beasts_tower_old;
CREATE TABLE beasts_tower (bt_id integer DEFAULT 0, floor integer DEFAULT 0, family_id integer DEFAULT 0);
ALTER TABLE public.beasts_tower OWNER TO spiritking;
REVOKE ALL ON TABLE beasts_tower FROM PUBLIC;
GRANT ALL ON TABLE beasts_tower TO postgres;

ALTER TABLE beasts_tower_members ADD family_id integer;
ALTER TABLE beasts_tower_members ALTER family_id SET DEFAULT 0;
UPDATE beasts_tower_members SET family_id = 0;

version 1601210002
DROP TABLE item_exchange_stock;
CREATE TABLE item_exchange_stock (account_id integer DEFAULT 0, exchange_id integer DEFAULT 0, in_stock integer DEFAULT 0);
ALTER TABLE public.item_exchange_stock OWNER TO spiritking;
REVOKE ALL ON TABLE item_exchange_stock FROM PUBLIC;
GRANT ALL ON TABLE item_exchange_stock TO postgres;

version 1602020000
DROP TABLE global_variables;
CREATE TABLE global_variables (id integer PRIMARY KEY, value integer DEFAULT 0);
ALTER TABLE public.global_variables OWNER TO spiritking;
REVOKE ALL ON TABLE global_variables FROM PUBLIC;
GRANT ALL ON TABLE global_variables TO postgres;


version 1602020001
ALTER TABLE player_characters ADD appellation_top1 integer;
ALTER TABLE player_characters ALTER appellation_top1 SET DEFAULT 0;
UPDATE player_characters SET appellation_top1 = 0;
ALTER TABLE player_characters ADD appellation_top2 integer;
ALTER TABLE player_characters ALTER appellation_top2 SET DEFAULT 0;
UPDATE player_characters SET appellation_top2 = 0;
ALTER TABLE player_characters ADD appellation_top3 integer;
ALTER TABLE player_characters ALTER appellation_top3 SET DEFAULT 0;
UPDATE player_characters SET appellation_top3 = 0;

version 1602020002
ALTER TABLE player_characters ADD equip_chair_item_id integer DEFAULT 0;

version 1703240001
ALTER TABLE auction ADD class_limit bit varying DEFAULT B'0';

version 1703240002
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";


version 1706190000
ALTER TABLE inventory1 ADD awake_level integer DEFAULT 0;
ALTER TABLE inventory1 ADD awake_potential integer DEFAULT 0;
ALTER TABLE inventory1 ADD awake_addition integer DEFAULT 0;
ALTER TABLE inventory2 ADD awake_level integer DEFAULT 0;
ALTER TABLE inventory2 ADD awake_potential integer DEFAULT 0;
ALTER TABLE inventory2 ADD awake_addition integer DEFAULT 0;

ALTER TABLE elfinventory ADD awake_level integer DEFAULT 0;
ALTER TABLE elfinventory ADD awake_potential integer DEFAULT 0;
ALTER TABLE elfinventory ADD awake_addition integer DEFAULT 0;

ALTER TABLE storage1 ADD awake_level integer DEFAULT 0;
ALTER TABLE storage1 ADD awake_potential integer DEFAULT 0;
ALTER TABLE storage1 ADD awake_addition integer DEFAULT 0;
ALTER TABLE storage2 ADD awake_level integer DEFAULT 0;
ALTER TABLE storage2 ADD awake_potential integer DEFAULT 0;
ALTER TABLE storage2 ADD awake_addition integer DEFAULT 0;

ALTER TABLE equipment1 ADD awake_level integer DEFAULT 0;
ALTER TABLE equipment1 ADD awake_potential integer DEFAULT 0;
ALTER TABLE equipment1 ADD awake_addition integer DEFAULT 0;
ALTER TABLE equipment2 ADD awake_level integer DEFAULT 0;
ALTER TABLE equipment2 ADD awake_potential integer DEFAULT 0;
ALTER TABLE equipment2 ADD awake_addition integer DEFAULT 0;

ALTER TABLE collection ADD awake_level integer DEFAULT 0;
ALTER TABLE collection ADD awake_potential integer DEFAULT 0;
ALTER TABLE collection ADD awake_addition integer DEFAULT 0;

ALTER TABLE isle_storage ADD awake_level integer DEFAULT 0;
ALTER TABLE isle_storage ADD awake_potential integer DEFAULT 0;
ALTER TABLE isle_storage ADD awake_addition integer DEFAULT 0;

ALTER TABLE family_storage ADD awake_level integer DEFAULT 0;
ALTER TABLE family_storage ADD awake_potential integer DEFAULT 0;
ALTER TABLE family_storage ADD awake_addition integer DEFAULT 0;

ALTER TABLE auction ADD awake_level integer DEFAULT 0;
ALTER TABLE auction ADD awake_potential integer DEFAULT 0;
ALTER TABLE auction ADD awake_addition integer DEFAULT 0;

ALTER TABLE sys_mail_queue ADD awake_level integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD awake_potential integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD awake_addition integer DEFAULT 0;

ALTER TABLE sys_mail_queue_new ADD awake_level integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD awake_potential integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD awake_addition integer DEFAULT 0;

ALTER TABLE mailitem ADD awake_level integer DEFAULT 0;
ALTER TABLE mailitem ADD awake_potential integer DEFAULT 0;
ALTER TABLE mailitem ADD awake_addition integer DEFAULT 0;

ALTER TABLE elf1 ADD awake_level1 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_potential1 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_addition1 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_level2 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_potential2 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_addition2 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_level3 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_potential3 integer DEFAULT 0;
ALTER TABLE elf1 ADD awake_addition3 integer DEFAULT 0;

ALTER TABLE elf2 ADD awake_level1 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_potential1 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_addition1 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_level2 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_potential2 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_addition2 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_level3 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_potential3 integer DEFAULT 0;
ALTER TABLE elf2 ADD awake_addition3 integer DEFAULT 0;

ALTER TABLE elf_container1 ADD awake_level integer DEFAULT 0;
ALTER TABLE elf_container1 ADD awake_potential integer DEFAULT 0;
ALTER TABLE elf_container1 ADD awake_addition integer DEFAULT 0;
ALTER TABLE elf_container2 ADD awake_level integer DEFAULT 0;
ALTER TABLE elf_container2 ADD awake_potential integer DEFAULT 0;
ALTER TABLE elf_container2 ADD awake_addition integer DEFAULT 0;

ALTER TABLE bags ADD awake_level integer DEFAULT 0;
ALTER TABLE bags ADD awake_potential integer DEFAULT 0;
ALTER TABLE bags ADD awake_addition integer DEFAULT 0;

version 1706200000
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1710310000
ALTER TABLE lover ADD love_challenge1 integer DEFAULT 0;
ALTER TABLE lover ADD love_challenge2 integer DEFAULT 0;

version 1801310002
ALTER TABLE inventory1 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE inventory1 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE inventory1 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE inventory1 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE inventory1 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE inventory1 ADD rune_combo_id5 integer DEFAULT 0;
ALTER TABLE inventory2 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE inventory2 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE inventory2 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE inventory2 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE inventory2 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE inventory2 ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE elfinventory ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE elfinventory ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE elfinventory ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE elfinventory ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE elfinventory ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE elfinventory ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE storage1 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE storage1 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE storage1 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE storage1 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE storage1 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE storage1 ADD rune_combo_id5 integer DEFAULT 0;
ALTER TABLE storage2 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE storage2 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE storage2 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE storage2 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE storage2 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE storage2 ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE equipment1 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE equipment1 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE equipment1 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE equipment1 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE equipment1 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE equipment1 ADD rune_combo_id5 integer DEFAULT 0;
ALTER TABLE equipment2 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE equipment2 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE equipment2 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE equipment2 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE equipment2 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE equipment2 ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE collection ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE collection ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE collection ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE collection ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE collection ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE collection ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE isle_storage ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE isle_storage ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE isle_storage ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE isle_storage ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE isle_storage ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE isle_storage ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE family_storage ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE family_storage ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE family_storage ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE family_storage ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE family_storage ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE family_storage ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE auction ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE auction ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE auction ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE auction ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE auction ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE auction ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE sys_mail_queue ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE sys_mail_queue ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE sys_mail_queue ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE sys_mail_queue_new ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE sys_mail_queue_new ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE sys_mail_queue_new ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE mailitem ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE mailitem ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE mailitem ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE mailitem ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE mailitem ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE mailitem ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE elf1 ADD combo_rune_slot1 integer DEFAULT -1;
ALTER TABLE elf1 ADD rune_combo_id1_1 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id1_2 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id1_3 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id1_4 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id1_5 integer DEFAULT 0;
ALTER TABLE elf1 ADD combo_rune_slot2 integer DEFAULT -1;
ALTER TABLE elf1 ADD rune_combo_id2_1 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id2_2 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id2_3 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id2_4 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id2_5 integer DEFAULT 0;
ALTER TABLE elf1 ADD combo_rune_slot3 integer DEFAULT -1;
ALTER TABLE elf1 ADD rune_combo_id3_1 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id3_2 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id3_3 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id3_4 integer DEFAULT 0;
ALTER TABLE elf1 ADD rune_combo_id3_5 integer DEFAULT 0;

ALTER TABLE elf2 ADD combo_rune_slot1 integer DEFAULT -1;
ALTER TABLE elf2 ADD rune_combo_id1_1 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id1_2 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id1_3 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id1_4 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id1_5 integer DEFAULT 0;
ALTER TABLE elf2 ADD combo_rune_slot2 integer DEFAULT -1;
ALTER TABLE elf2 ADD rune_combo_id2_1 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id2_2 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id2_3 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id2_4 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id2_5 integer DEFAULT 0;
ALTER TABLE elf2 ADD combo_rune_slot3 integer DEFAULT -1;
ALTER TABLE elf2 ADD rune_combo_id3_1 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id3_2 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id3_3 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id3_4 integer DEFAULT 0;
ALTER TABLE elf2 ADD rune_combo_id3_5 integer DEFAULT 0;

ALTER TABLE elf_container1 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE elf_container1 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE elf_container1 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE elf_container1 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE elf_container1 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE elf_container1 ADD rune_combo_id5 integer DEFAULT 0;
ALTER TABLE elf_container2 ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE elf_container2 ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE elf_container2 ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE elf_container2 ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE elf_container2 ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE elf_container2 ADD rune_combo_id5 integer DEFAULT 0;

ALTER TABLE bags ADD combo_rune_slot integer DEFAULT -1;
ALTER TABLE bags ADD rune_combo_id1 integer DEFAULT 0;
ALTER TABLE bags ADD rune_combo_id2 integer DEFAULT 0;
ALTER TABLE bags ADD rune_combo_id3 integer DEFAULT 0;
ALTER TABLE bags ADD rune_combo_id4 integer DEFAULT 0;
ALTER TABLE bags ADD rune_combo_id5 integer DEFAULT 0;

version 1801310003
DROP VIEW "auction_view_by_level_up";
DROP VIEW "auction_view_by_level_dn";
DROP VIEW "auction_view_by_quality_up";
DROP VIEW "auction_view_by_quality_dn";
DROP VIEW "auction_view_by_duedate_up";
DROP VIEW "auction_view_by_duedate_dn";
DROP VIEW "auction_view_by_price_up";
DROP VIEW "auction_view_by_price_dn";
CREATE VIEW "auction_view_by_level_up" AS SELECT * FROM "auction" ORDER BY level;
CREATE VIEW "auction_view_by_level_dn" AS SELECT * FROM "auction" ORDER BY level DESC;
CREATE VIEW "auction_view_by_quality_up" AS SELECT * FROM "auction" ORDER BY quality;
CREATE VIEW "auction_view_by_quality_dn" AS SELECT * FROM "auction" ORDER BY quality DESC;
CREATE VIEW "auction_view_by_duedate_up" AS SELECT * FROM "auction" ORDER BY auction_duedate;
CREATE VIEW "auction_view_by_duedate_dn" AS SELECT * FROM "auction" ORDER BY auction_duedate DESC;
CREATE VIEW "auction_view_by_price_up" AS SELECT * FROM "auction" ORDER BY auction_price;
CREATE VIEW "auction_view_by_price_dn" AS SELECT * FROM "auction" ORDER BY auction_price DESC;
REVOKE ALL on "auction_view_by_level_up" from PUBLIC;
GRANT ALL on "auction_view_by_level_up" to "postgres";
GRANT ALL on "auction_view_by_level_up" to "spiritking";
REVOKE ALL on "auction_view_by_level_dn" from PUBLIC;
GRANT ALL on "auction_view_by_level_dn" to "postgres";
GRANT ALL on "auction_view_by_level_dn" to "spiritking";
REVOKE ALL on "auction_view_by_quality_up" from PUBLIC;
GRANT ALL on "auction_view_by_quality_up" to "postgres";
GRANT ALL on "auction_view_by_quality_up" to "spiritking";
REVOKE ALL on "auction_view_by_quality_dn" from PUBLIC;
GRANT ALL on "auction_view_by_quality_dn" to "postgres";
GRANT ALL on "auction_view_by_quality_dn" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_up" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_up" to "postgres";
GRANT ALL on "auction_view_by_duedate_up" to "spiritking";
REVOKE ALL on "auction_view_by_duedate_dn" from PUBLIC;
GRANT ALL on "auction_view_by_duedate_dn" to "postgres";
GRANT ALL on "auction_view_by_duedate_dn" to "spiritking";
REVOKE ALL on "auction_view_by_price_up" from PUBLIC;
GRANT ALL on "auction_view_by_price_up" to "postgres";
GRANT ALL on "auction_view_by_price_up" to "spiritking";
REVOKE ALL on "auction_view_by_price_dn" from PUBLIC;
GRANT ALL on "auction_view_by_price_dn" to "postgres";
GRANT ALL on "auction_view_by_price_dn" to "spiritking";

version 1808021000
CREATE TABLE elf_temple_team (id integer PRIMARY KEY, leader_id integer DEFAULT 0, members text , road_index integer DEFAULT 0, events text, stage integer DEFAULT 0);
ALTER TABLE public.elf_temple_team OWNER TO spiritking;
REVOKE ALL ON TABLE elf_temple_team FROM PUBLIC;
GRANT ALL ON TABLE elf_temple_team TO postgres;
ALTER TABLE player_characters ADD elf_temple_team_id integer DEFAULT 0;

version 1808071000
ALTER TABLE account_shared ADD rainbowroad_enter_count integer DEFAULT 0;

version 1808271000
UPDATE account_shared SET daily_update_time = 0, rainbowroad_enter_count = -1;

version 1809201137
ALTER TABLE player_characters ADD equip_crystal_combo_item_id integer;
ALTER TABLE player_characters ALTER equip_crystal_combo_item_id SET DEFAULT 0;
UPDATE player_characters SET equip_crystal_combo_item_id = 0;

version 1810081333 
ALTER TABLE family ADD wishing_well_id integer DEFAULT 0;
ALTER TABLE family ADD wishing_well_create_time timestamp with time zone;   

version 1908071105
CREATE TABLE old_player_enchants AS SELECT * FROM player_enchants;
UPDATE player_enchants SET effect_id=(effect_id + 10000) *-1 WHERE effect_id >= 1000 AND effect_id <= 11000;
UPDATE player_enchants SET effect_id=(effect_id + 25000) *-1 WHERE effect_id >= 20000 AND effect_id <= 45000;

version 1909231650
DELETE FROM player_enchants  WHERE effect_id = -2;
DELETE FROM player_enchants  WHERE effect_id = -3;
DELETE FROM player_enchants  WHERE effect_id = -4;
DELETE FROM player_enchants  WHERE effect_id = -5;

UPDATE player_enchants SET effect_id=-2 WHERE effect_id =65534;
UPDATE player_enchants SET effect_id=-3 WHERE effect_id =65533;
UPDATE player_enchants SET effect_id=-4 WHERE effect_id =65532;
UPDATE player_enchants SET effect_id=-5 WHERE effect_id =65531;

version 1912171200
UPDATE player_enchants SET effect_id=101 WHERE effect_id =4;
UPDATE player_enchants SET effect_id=102 WHERE effect_id =5;
UPDATE player_enchants SET effect_id=103 WHERE effect_id =6;

version 2002121400
UPDATE inventory1 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE inventory1 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE inventory1 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE inventory1 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE inventory1 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE inventory1 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE inventory1 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE inventory2 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE inventory2 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE inventory2 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE inventory2 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE inventory2 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE inventory2 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE inventory2 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE elfinventory SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE elfinventory SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE elfinventory SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE elfinventory SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE elfinventory SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE elfinventory SET awake_potential=0 WHERE awake_potential =65535;
UPDATE elfinventory SET awake_addition=0 WHERE awake_addition =65535;

UPDATE storage1 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE storage1 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE storage1 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE storage1 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE storage1 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE storage1 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE storage1 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE storage2 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE storage2 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE storage2 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE storage2 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE storage2 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE storage2 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE storage2 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE equipment1 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE equipment1 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE equipment1 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE equipment1 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE equipment1 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE equipment1 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE equipment1 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE equipment2 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE equipment2 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE equipment2 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE equipment2 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE equipment2 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE equipment2 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE equipment2 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE collection SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE collection SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE collection SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE collection SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE collection SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE collection SET awake_potential=0 WHERE awake_potential =65535;
UPDATE collection SET awake_addition=0 WHERE awake_addition =65535;

UPDATE isle_storage SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE isle_storage SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE isle_storage SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE isle_storage SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE isle_storage SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE isle_storage SET awake_potential=0 WHERE awake_potential =65535;
UPDATE isle_storage SET awake_addition=0 WHERE awake_addition =65535;

UPDATE family_storage SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE family_storage SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE family_storage SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE family_storage SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE family_storage SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE family_storage SET awake_potential=0 WHERE awake_potential =65535;
UPDATE family_storage SET awake_addition=0 WHERE awake_addition =65535;

UPDATE auction SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE auction SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE auction SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE auction SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE auction SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE auction SET awake_potential=0 WHERE awake_potential =65535;
UPDATE auction SET awake_addition=0 WHERE awake_addition =65535;

UPDATE sys_mail_queue SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE sys_mail_queue SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE sys_mail_queue SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE sys_mail_queue SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE sys_mail_queue SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE sys_mail_queue SET awake_potential=0 WHERE awake_potential =65535;
UPDATE sys_mail_queue SET awake_addition=0 WHERE awake_addition =65535;

UPDATE sys_mail_queue_new SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE sys_mail_queue_new SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE sys_mail_queue_new SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE sys_mail_queue_new SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE sys_mail_queue_new SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE sys_mail_queue_new SET awake_potential=0 WHERE awake_potential =65535;
UPDATE sys_mail_queue_new SET awake_addition=0 WHERE awake_addition =65535;

UPDATE mailitem SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE mailitem SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE mailitem SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE mailitem SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE mailitem SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE mailitem SET awake_potential=0 WHERE awake_potential =65535;
UPDATE mailitem SET awake_addition=0 WHERE awake_addition =65535;

UPDATE elf_container1 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE elf_container1 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE elf_container1 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE elf_container1 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE elf_container1 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE elf_container1 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE elf_container1 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE elf_container2 SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE elf_container2 SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE elf_container2 SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE elf_container2 SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE elf_container2 SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE elf_container2 SET awake_potential=0 WHERE awake_potential =65535;
UPDATE elf_container2 SET awake_addition=0 WHERE awake_addition =65535;

UPDATE bags SET rune_combo_id1=0 WHERE rune_combo_id1 =65535;
UPDATE bags SET rune_combo_id2=0 WHERE rune_combo_id2 =65535;
UPDATE bags SET rune_combo_id3=0 WHERE rune_combo_id3 =65535;
UPDATE bags SET rune_combo_id4=0 WHERE rune_combo_id4 =65535;
UPDATE bags SET rune_combo_id5=0 WHERE rune_combo_id5 =65535;
UPDATE bags SET awake_potential=0 WHERE awake_potential =65535;
UPDATE bags SET awake_addition=0 WHERE awake_addition =65535;

version 2002211700
UPDATE inventory1 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE inventory2 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE elfinventory SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE storage1 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE storage2 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE equipment1 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE equipment2 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE collection SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE isle_storage SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE family_storage SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE auction SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE sys_mail_queue SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE sys_mail_queue_new SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE mailitem SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE elf_container1 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE elf_container2 SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;
UPDATE bags SET combo_rune_slot = -1 WHERE combo_rune_slot = 0 AND (rune_combo_id1+rune_combo_id2+rune_combo_id3+rune_combo_id4+rune_combo_id5) = 0;

version 2006081400
CREATE TABLE player_characters_setting (player_id integer NOT NULL,elfpick_setting integer DEFAULT 255);
ALTER TABLE public.player_characters_setting OWNER TO postgres;
REVOKE ALL ON TABLE player_characters_setting FROM PUBLIC;
REVOKE ALL ON TABLE player_characters_setting FROM postgres;
GRANT ALL ON TABLE player_characters_setting TO postgres;
GRANT ALL ON TABLE player_characters_setting TO spiritking;
ALTER TABLE ONLY player_characters_setting ADD CONSTRAINT player_characters_setting_pkey PRIMARY KEY (player_id);
INSERT INTO player_characters_setting (player_id) SELECT id FROM player_characters;